"use strict";var t=require("path"),e=require("libnpmpack"),i=require("events"),s=require("stream"),r=require("string_decoder"),n=require("assert"),h=require("buffer"),o=require("zlib"),a=require("fs"),l=require("util"),u=require("crypto");function c(t){return t&&"object"==typeof t&&"default"in t?t:{default:t}}var d=c(t),f=c(e),p=c(i),m=c(s),y=c(r),b=c(n),w=c(h),E=c(o),g=c(a),_=c(l),S=c(u),R="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function O(t){var e={exports:{}};return t(e,e.exports),e.exports}var v=O((function(t){const e=new Map([["C","cwd"],["f","file"],["z","gzip"],["P","preservePaths"],["U","unlink"],["strip-components","strip"],["stripComponents","strip"],["keep-newer","newer"],["keepNewer","newer"],["keep-newer-files","newer"],["keepNewerFiles","newer"],["k","keep"],["keep-existing","keep"],["keepExisting","keep"],["m","noMtime"],["no-mtime","noMtime"],["p","preserveOwner"],["L","follow"],["h","follow"]]);t.exports=t=>t?Object.keys(t).map((i=>[e.has(i)?e.get(i):i,t[i]])).reduce(((t,e)=>(t[e[0]]=e[1],t)),Object.create(null)):{}})),T=k;function k(t){var e=this;if(e instanceof k||(e=new k),e.tail=null,e.head=null,e.length=0,t&&"function"==typeof t.forEach)t.forEach((function(t){e.push(t)}));else if(arguments.length>0)for(var i=0,s=arguments.length;i<s;i++)e.push(arguments[i]);return e}function L(t,e,i){var s=e===t.head?new D(i,null,e,t):new D(i,e,e.next,t);return null===s.next&&(t.tail=s),null===s.prev&&(t.head=s),t.length++,s}function A(t,e){t.tail=new D(e,t.tail,null,t),t.head||(t.head=t.tail),t.length++}function I(t,e){t.head=new D(e,null,t.head,t),t.tail||(t.tail=t.head),t.length++}function D(t,e,i,s){if(!(this instanceof D))return new D(t,e,i,s);this.list=s,this.value=t,e?(e.next=this,this.prev=e):this.prev=null,i?(i.prev=this,this.next=i):this.next=null}k.Node=D,k.create=k,k.prototype.removeNode=function(t){if(t.list!==this)throw new Error("removing node which does not belong to this list");var e=t.next,i=t.prev;return e&&(e.prev=i),i&&(i.next=e),t===this.head&&(this.head=e),t===this.tail&&(this.tail=i),t.list.length--,t.next=null,t.prev=null,t.list=null,e},k.prototype.unshiftNode=function(t){if(t!==this.head){t.list&&t.list.removeNode(t);var e=this.head;t.list=this,t.next=e,e&&(e.prev=t),this.head=t,this.tail||(this.tail=t),this.length++}},k.prototype.pushNode=function(t){if(t!==this.tail){t.list&&t.list.removeNode(t);var e=this.tail;t.list=this,t.prev=e,e&&(e.next=t),this.tail=t,this.head||(this.head=t),this.length++}},k.prototype.push=function(){for(var t=0,e=arguments.length;t<e;t++)A(this,arguments[t]);return this.length},k.prototype.unshift=function(){for(var t=0,e=arguments.length;t<e;t++)I(this,arguments[t]);return this.length},k.prototype.pop=function(){if(this.tail){var t=this.tail.value;return this.tail=this.tail.prev,this.tail?this.tail.next=null:this.head=null,this.length--,t}},k.prototype.shift=function(){if(this.head){var t=this.head.value;return this.head=this.head.next,this.head?this.head.prev=null:this.tail=null,this.length--,t}},k.prototype.forEach=function(t,e){e=e||this;for(var i=this.head,s=0;null!==i;s++)t.call(e,i.value,s,this),i=i.next},k.prototype.forEachReverse=function(t,e){e=e||this;for(var i=this.tail,s=this.length-1;null!==i;s--)t.call(e,i.value,s,this),i=i.prev},k.prototype.get=function(t){for(var e=0,i=this.head;null!==i&&e<t;e++)i=i.next;if(e===t&&null!==i)return i.value},k.prototype.getReverse=function(t){for(var e=0,i=this.tail;null!==i&&e<t;e++)i=i.prev;if(e===t&&null!==i)return i.value},k.prototype.map=function(t,e){e=e||this;for(var i=new k,s=this.head;null!==s;)i.push(t.call(e,s.value,this)),s=s.next;return i},k.prototype.mapReverse=function(t,e){e=e||this;for(var i=new k,s=this.tail;null!==s;)i.push(t.call(e,s.value,this)),s=s.prev;return i},k.prototype.reduce=function(t,e){var i,s=this.head;if(arguments.length>1)i=e;else{if(!this.head)throw new TypeError("Reduce of empty list with no initial value");s=this.head.next,i=this.head.value}for(var r=0;null!==s;r++)i=t(i,s.value,r),s=s.next;return i},k.prototype.reduceReverse=function(t,e){var i,s=this.tail;if(arguments.length>1)i=e;else{if(!this.tail)throw new TypeError("Reduce of empty list with no initial value");s=this.tail.prev,i=this.tail.value}for(var r=this.length-1;null!==s;r--)i=t(i,s.value,r),s=s.prev;return i},k.prototype.toArray=function(){for(var t=new Array(this.length),e=0,i=this.head;null!==i;e++)t[e]=i.value,i=i.next;return t},k.prototype.toArrayReverse=function(){for(var t=new Array(this.length),e=0,i=this.tail;null!==i;e++)t[e]=i.value,i=i.prev;return t},k.prototype.slice=function(t,e){(e=e||this.length)<0&&(e+=this.length),(t=t||0)<0&&(t+=this.length);var i=new k;if(e<t||e<0)return i;t<0&&(t=0),e>this.length&&(e=this.length);for(var s=0,r=this.head;null!==r&&s<t;s++)r=r.next;for(;null!==r&&s<e;s++,r=r.next)i.push(r.value);return i},k.prototype.sliceReverse=function(t,e){(e=e||this.length)<0&&(e+=this.length),(t=t||0)<0&&(t+=this.length);var i=new k;if(e<t||e<0)return i;t<0&&(t=0),e>this.length&&(e=this.length);for(var s=this.length,r=this.tail;null!==r&&s>e;s--)r=r.prev;for(;null!==r&&s>t;s--,r=r.prev)i.push(r.value);return i},k.prototype.splice=function(t,e,...i){t>this.length&&(t=this.length-1),t<0&&(t=this.length+t);for(var s=0,r=this.head;null!==r&&s<t;s++)r=r.next;var n=[];for(s=0;r&&s<e;s++)n.push(r.value),r=this.removeNode(r);null===r&&(r=this.tail),r!==this.head&&r!==this.tail&&(r=r.prev);for(s=0;s<i.length;s++)r=L(this,r,i[s]);return n},k.prototype.reverse=function(){for(var t=this.head,e=this.tail,i=t;null!==i;i=i.prev){var s=i.prev;i.prev=i.next,i.next=s}return this.head=e,this.tail=t,this};try{!function(t){t.prototype[Symbol.iterator]=function*(){for(let t=this.head;t;t=t.next)yield t.value}}(k)}catch(t){}const N=y.default.StringDecoder,x=Symbol("EOF"),B=Symbol("maybeEmitEnd"),M=Symbol("emittedEnd"),C=Symbol("emittingEnd"),F=Symbol("closed"),P=Symbol("read"),z=Symbol("flush"),U=Symbol("flushChunk"),j=Symbol("encoding"),H=Symbol("decoder"),G=Symbol("flowing"),Z=Symbol("paused"),W=Symbol("resume"),V=Symbol("bufferLength"),Y=Symbol("bufferPush"),$=Symbol("bufferShift"),q=Symbol("objectMode"),X=Symbol("destroyed"),K="1"!==R._MP_NO_ITERATOR_SYMBOLS_,Q=K&&Symbol.asyncIterator||Symbol("asyncIterator not implemented"),J=K&&Symbol.iterator||Symbol("iterator not implemented"),tt=t=>"end"===t||"finish"===t||"prefinish"===t;var et=class t extends m.default{constructor(t){super(),this[G]=!1,this[Z]=!1,this.pipes=new T,this.buffer=new T,this[q]=t&&t.objectMode||!1,this[q]?this[j]=null:this[j]=t&&t.encoding||null,"buffer"===this[j]&&(this[j]=null),this[H]=this[j]?new N(this[j]):null,this[x]=!1,this[M]=!1,this[C]=!1,this[F]=!1,this.writable=!0,this.readable=!0,this[V]=0,this[X]=!1}get bufferLength(){return this[V]}get encoding(){return this[j]}set encoding(t){if(this[q])throw new Error("cannot set encoding in objectMode");if(this[j]&&t!==this[j]&&(this[H]&&this[H].lastNeed||this[V]))throw new Error("cannot change encoding");this[j]!==t&&(this[H]=t?new N(t):null,this.buffer.length&&(this.buffer=this.buffer.map((t=>this[H].write(t))))),this[j]=t}setEncoding(t){this.encoding=t}get objectMode(){return this[q]}set objectMode(t){this[q]=this[q]||!!t}write(t,e,i){if(this[x])throw new Error("write after end");return this[X]?(this.emit("error",Object.assign(new Error("Cannot call write after a stream was destroyed"),{code:"ERR_STREAM_DESTROYED"})),!0):("function"==typeof e&&(i=e,e="utf8"),e||(e="utf8"),this[q]||Buffer.isBuffer(t)||(s=t,!Buffer.isBuffer(s)&&ArrayBuffer.isView(s)?t=Buffer.from(t.buffer,t.byteOffset,t.byteLength):(t=>t instanceof ArrayBuffer||"object"==typeof t&&t.constructor&&"ArrayBuffer"===t.constructor.name&&t.byteLength>=0)(t)?t=Buffer.from(t):"string"!=typeof t&&(this.objectMode=!0)),this.objectMode||t.length?("string"!=typeof t||this[q]||e===this[j]&&!this[H].lastNeed||(t=Buffer.from(t,e)),Buffer.isBuffer(t)&&this[j]&&(t=this[H].write(t)),this.flowing?(0!==this[V]&&this[z](!0),this.emit("data",t)):this[Y](t),0!==this[V]&&this.emit("readable"),i&&i(),this.flowing):(0!==this[V]&&this.emit("readable"),i&&i(),this.flowing));var s}read(t){if(this[X])return null;try{return 0===this[V]||0===t||t>this[V]?null:(this[q]&&(t=null),this.buffer.length>1&&!this[q]&&(this.encoding?this.buffer=new T([Array.from(this.buffer).join("")]):this.buffer=new T([Buffer.concat(Array.from(this.buffer),this[V])])),this[P](t||null,this.buffer.head.value))}finally{this[B]()}}[P](t,e){return t===e.length||null===t?this[$]():(this.buffer.head.value=e.slice(t),e=e.slice(0,t),this[V]-=t),this.emit("data",e),this.buffer.length||this[x]||this.emit("drain"),e}end(t,e,i){return"function"==typeof t&&(i=t,t=null),"function"==typeof e&&(i=e,e="utf8"),t&&this.write(t,e),i&&this.once("end",i),this[x]=!0,this.writable=!1,!this.flowing&&this[Z]||this[B](),this}[W](){this[X]||(this[Z]=!1,this[G]=!0,this.emit("resume"),this.buffer.length?this[z]():this[x]?this[B]():this.emit("drain"))}resume(){return this[W]()}pause(){this[G]=!1,this[Z]=!0}get destroyed(){return this[X]}get flowing(){return this[G]}get paused(){return this[Z]}[Y](t){return this[q]?this[V]+=1:this[V]+=t.length,this.buffer.push(t)}[$](){return this.buffer.length&&(this[q]?this[V]-=1:this[V]-=this.buffer.head.value.length),this.buffer.shift()}[z](t){do{}while(this[U](this[$]()));t||this.buffer.length||this[x]||this.emit("drain")}[U](t){return!!t&&(this.emit("data",t),this.flowing)}pipe(t,e){if(this[X])return;const i=this[M];e=e||{},t===process.stdout||t===process.stderr?e.end=!1:e.end=!1!==e.end;const s={dest:t,opts:e,ondrain:t=>this[W]()};return this.pipes.push(s),t.on("drain",s.ondrain),this[W](),i&&s.opts.end&&s.dest.end(),t}addListener(t,e){return this.on(t,e)}on(t,e){try{return super.on(t,e)}finally{"data"!==t||this.pipes.length||this.flowing?tt(t)&&this[M]&&(super.emit(t),this.removeAllListeners(t)):this[W]()}}get emittedEnd(){return this[M]}[B](){this[C]||this[M]||this[X]||0!==this.buffer.length||!this[x]||(this[C]=!0,this.emit("end"),this.emit("prefinish"),this.emit("finish"),this[F]&&this.emit("close"),this[C]=!1)}emit(t,e){if("error"!==t&&"close"!==t&&t!==X&&this[X])return;if("data"===t){if(!e)return;this.pipes.length&&this.pipes.forEach((t=>!1===t.dest.write(e)&&this.pause()))}else if("end"===t){if(!0===this[M])return;this[M]=!0,this.readable=!1,this[H]&&(e=this[H].end())&&(this.pipes.forEach((t=>t.dest.write(e))),super.emit("data",e)),this.pipes.forEach((t=>{t.dest.removeListener("drain",t.ondrain),t.opts.end&&t.dest.end()}))}else if("close"===t&&(this[F]=!0,!this[M]&&!this[X]))return;const i=new Array(arguments.length);if(i[0]=t,i[1]=e,arguments.length>2)for(let t=2;t<arguments.length;t++)i[t]=arguments[t];try{return super.emit.apply(this,i)}finally{tt(t)?this.removeAllListeners(t):this[B]()}}collect(){const t=[];this[q]||(t.dataLength=0);const e=this.promise();return this.on("data",(e=>{t.push(e),this[q]||(t.dataLength+=e.length)})),e.then((()=>t))}concat(){return this[q]?Promise.reject(new Error("cannot concat in objectMode")):this.collect().then((t=>this[q]?Promise.reject(new Error("cannot concat in objectMode")):this[j]?t.join(""):Buffer.concat(t,t.dataLength)))}promise(){return new Promise(((t,e)=>{this.on(X,(()=>e(new Error("stream destroyed")))),this.on("end",(()=>t())),this.on("error",(t=>e(t)))}))}[Q](){return{next:()=>{const t=this.read();if(null!==t)return Promise.resolve({done:!1,value:t});if(this[x])return Promise.resolve({done:!0});let e=null,i=null;const s=t=>{this.removeListener("data",r),this.removeListener("end",n),i(t)},r=t=>{this.removeListener("error",s),this.removeListener("end",n),this.pause(),e({value:t,done:!!this[x]})},n=()=>{this.removeListener("error",s),this.removeListener("data",r),e({done:!0})},h=()=>s(new Error("stream destroyed"));return new Promise(((t,o)=>{i=o,e=t,this.once(X,h),this.once("error",s),this.once("end",n),this.once("data",r)}))}}}[J](){return{next:()=>{const t=this.read();return{value:t,done:null===t}}}}destroy(t){return this[X]?(t?this.emit("error",t):this.emit(X),this):(this[X]=!0,this.buffer=new T,this[V]=0,"function"!=typeof this.close||this[F]||this.close(),t?this.emit("error",t):this.emit(X),this)}static isStream(e){return!!e&&(e instanceof t||e instanceof m.default||e instanceof p.default&&("function"==typeof e.pipe||"function"==typeof e.write&&"function"==typeof e.end))}};const it=E.default.constants||{ZLIB_VERNUM:4736};var st=Object.freeze(Object.assign(Object.create(null),{Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_MEM_ERROR:-4,Z_BUF_ERROR:-5,Z_VERSION_ERROR:-6,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,DEFLATE:1,INFLATE:2,GZIP:3,GUNZIP:4,DEFLATERAW:5,INFLATERAW:6,UNZIP:7,BROTLI_DECODE:8,BROTLI_ENCODE:9,Z_MIN_WINDOWBITS:8,Z_MAX_WINDOWBITS:15,Z_DEFAULT_WINDOWBITS:15,Z_MIN_CHUNK:64,Z_MAX_CHUNK:1/0,Z_DEFAULT_CHUNK:16384,Z_MIN_MEMLEVEL:1,Z_MAX_MEMLEVEL:9,Z_DEFAULT_MEMLEVEL:8,Z_MIN_LEVEL:-1,Z_MAX_LEVEL:9,Z_DEFAULT_LEVEL:-1,BROTLI_OPERATION_PROCESS:0,BROTLI_OPERATION_FLUSH:1,BROTLI_OPERATION_FINISH:2,BROTLI_OPERATION_EMIT_METADATA:3,BROTLI_MODE_GENERIC:0,BROTLI_MODE_TEXT:1,BROTLI_MODE_FONT:2,BROTLI_DEFAULT_MODE:0,BROTLI_MIN_QUALITY:0,BROTLI_MAX_QUALITY:11,BROTLI_DEFAULT_QUALITY:11,BROTLI_MIN_WINDOW_BITS:10,BROTLI_MAX_WINDOW_BITS:24,BROTLI_LARGE_MAX_WINDOW_BITS:30,BROTLI_DEFAULT_WINDOW:22,BROTLI_MIN_INPUT_BLOCK_BITS:16,BROTLI_MAX_INPUT_BLOCK_BITS:24,BROTLI_PARAM_MODE:0,BROTLI_PARAM_QUALITY:1,BROTLI_PARAM_LGWIN:2,BROTLI_PARAM_LGBLOCK:3,BROTLI_PARAM_DISABLE_LITERAL_CONTEXT_MODELING:4,BROTLI_PARAM_SIZE_HINT:5,BROTLI_PARAM_LARGE_WINDOW:6,BROTLI_PARAM_NPOSTFIX:7,BROTLI_PARAM_NDIRECT:8,BROTLI_DECODER_RESULT_ERROR:0,BROTLI_DECODER_RESULT_SUCCESS:1,BROTLI_DECODER_RESULT_NEEDS_MORE_INPUT:2,BROTLI_DECODER_RESULT_NEEDS_MORE_OUTPUT:3,BROTLI_DECODER_PARAM_DISABLE_RING_BUFFER_REALLOCATION:0,BROTLI_DECODER_PARAM_LARGE_WINDOW:1,BROTLI_DECODER_NO_ERROR:0,BROTLI_DECODER_SUCCESS:1,BROTLI_DECODER_NEEDS_MORE_INPUT:2,BROTLI_DECODER_NEEDS_MORE_OUTPUT:3,BROTLI_DECODER_ERROR_FORMAT_EXUBERANT_NIBBLE:-1,BROTLI_DECODER_ERROR_FORMAT_RESERVED:-2,BROTLI_DECODER_ERROR_FORMAT_EXUBERANT_META_NIBBLE:-3,BROTLI_DECODER_ERROR_FORMAT_SIMPLE_HUFFMAN_ALPHABET:-4,BROTLI_DECODER_ERROR_FORMAT_SIMPLE_HUFFMAN_SAME:-5,BROTLI_DECODER_ERROR_FORMAT_CL_SPACE:-6,BROTLI_DECODER_ERROR_FORMAT_HUFFMAN_SPACE:-7,BROTLI_DECODER_ERROR_FORMAT_CONTEXT_MAP_REPEAT:-8,BROTLI_DECODER_ERROR_FORMAT_BLOCK_LENGTH_1:-9,BROTLI_DECODER_ERROR_FORMAT_BLOCK_LENGTH_2:-10,BROTLI_DECODER_ERROR_FORMAT_TRANSFORM:-11,BROTLI_DECODER_ERROR_FORMAT_DICTIONARY:-12,BROTLI_DECODER_ERROR_FORMAT_WINDOW_BITS:-13,BROTLI_DECODER_ERROR_FORMAT_PADDING_1:-14,BROTLI_DECODER_ERROR_FORMAT_PADDING_2:-15,BROTLI_DECODER_ERROR_FORMAT_DISTANCE:-16,BROTLI_DECODER_ERROR_DICTIONARY_NOT_SET:-19,BROTLI_DECODER_ERROR_INVALID_ARGUMENTS:-20,BROTLI_DECODER_ERROR_ALLOC_CONTEXT_MODES:-21,BROTLI_DECODER_ERROR_ALLOC_TREE_GROUPS:-22,BROTLI_DECODER_ERROR_ALLOC_CONTEXT_MAP:-25,BROTLI_DECODER_ERROR_ALLOC_RING_BUFFER_1:-26,BROTLI_DECODER_ERROR_ALLOC_RING_BUFFER_2:-27,BROTLI_DECODER_ERROR_ALLOC_BLOCK_TYPE_TREES:-30,BROTLI_DECODER_ERROR_UNREACHABLE:-31},it)),rt=O((function(t,e){const i=w.default.Buffer,s=e.constants=st,r=i.concat,n=Symbol("_superWrite");class h extends Error{constructor(t){super("zlib: "+t.message),this.code=t.code,this.errno=t.errno,this.code||(this.code="ZLIB_ERROR"),this.message="zlib: "+t.message,Error.captureStackTrace(this,this.constructor)}get name(){return"ZlibError"}}const o=Symbol("opts"),a=Symbol("flushFlag"),l=Symbol("finishFlushFlag"),u=Symbol("fullFlushFlag"),c=Symbol("handle"),d=Symbol("onError"),f=Symbol("sawError"),p=Symbol("level"),m=Symbol("strategy"),y=Symbol("ended");class g extends et{constructor(t,e){if(!t||"object"!=typeof t)throw new TypeError("invalid options for ZlibBase constructor");super(t),this[f]=!1,this[y]=!1,this[o]=t,this[a]=t.flush,this[l]=t.finishFlush;try{this[c]=new E.default[e](t)}catch(t){throw new h(t)}this[d]=t=>{this[f]||(this[f]=!0,this.close(),this.emit("error",t))},this[c].on("error",(t=>this[d](new h(t)))),this.once("end",(()=>this.close))}close(){this[c]&&(this[c].close(),this[c]=null,this.emit("close"))}reset(){if(!this[f])return b.default(this[c],"zlib binding closed"),this[c].reset()}flush(t){this.ended||("number"!=typeof t&&(t=this[u]),this.write(Object.assign(i.alloc(0),{[a]:t})))}end(t,e,i){return t&&this.write(t,e),this.flush(this[l]),this[y]=!0,super.end(null,null,i)}get ended(){return this[y]}write(t,e,s){if("function"==typeof e&&(s=e,e="utf8"),"string"==typeof t&&(t=i.from(t,e)),this[f])return;b.default(this[c],"zlib binding closed");const o=this[c]._handle,l=o.close;o.close=()=>{};const u=this[c].close;let p,m;this[c].close=()=>{},i.concat=t=>t;try{const e="number"==typeof t[a]?t[a]:this[a];p=this[c]._processChunk(t,e),i.concat=r}catch(t){i.concat=r,this[d](new h(t))}finally{this[c]&&(this[c]._handle=o,o.close=l,this[c].close=u,this[c].removeAllListeners("error"))}if(this[c]&&this[c].on("error",(t=>this[d](new h(t)))),p)if(Array.isArray(p)&&p.length>0){m=this[n](i.from(p[0]));for(let t=1;t<p.length;t++)m=this[n](p[t])}else m=this[n](i.from(p));return s&&s(),m}[n](t){return super.write(t)}}class _ extends g{constructor(t,e){(t=t||{}).flush=t.flush||s.Z_NO_FLUSH,t.finishFlush=t.finishFlush||s.Z_FINISH,super(t,e),this[u]=s.Z_FULL_FLUSH,this[p]=t.level,this[m]=t.strategy}params(t,e){if(!this[f]){if(!this[c])throw new Error("cannot switch params when binding is closed");if(!this[c].params)throw new Error("not supported in this implementation");if(this[p]!==t||this[m]!==e){this.flush(s.Z_SYNC_FLUSH),b.default(this[c],"zlib binding closed");const i=this[c].flush;this[c].flush=(t,e)=>{this.flush(t),e()};try{this[c].params(t,e)}finally{this[c].flush=i}this[c]&&(this[p]=t,this[m]=e)}}}}const S=Symbol("_portable");class R extends g{constructor(t,e){(t=t||{}).flush=t.flush||s.BROTLI_OPERATION_PROCESS,t.finishFlush=t.finishFlush||s.BROTLI_OPERATION_FINISH,super(t,e),this[u]=s.BROTLI_OPERATION_FLUSH}}class O extends R{constructor(t){super(t,"BrotliCompress")}}class v extends R{constructor(t){super(t,"BrotliDecompress")}}e.Deflate=class extends _{constructor(t){super(t,"Deflate")}},e.Inflate=class extends _{constructor(t){super(t,"Inflate")}},e.Gzip=class extends _{constructor(t){super(t,"Gzip"),this[S]=t&&!!t.portable}[n](t){return this[S]?(this[S]=!1,t[9]=255,super[n](t)):super[n](t)}},e.Gunzip=class extends _{constructor(t){super(t,"Gunzip")}},e.DeflateRaw=class extends _{constructor(t){super(t,"DeflateRaw")}},e.InflateRaw=class extends _{constructor(t){super(t,"InflateRaw")}},e.Unzip=class extends _{constructor(t){super(t,"Unzip")}},"function"==typeof E.default.BrotliCompress?(e.BrotliCompress=O,e.BrotliDecompress=v):e.BrotliCompress=e.BrotliDecompress=class{constructor(){throw new Error("Brotli is not supported in this version of Node.js")}}})),nt=O((function(t,e){e.name=new Map([["0","File"],["","OldFile"],["1","Link"],["2","SymbolicLink"],["3","CharacterDevice"],["4","BlockDevice"],["5","Directory"],["6","FIFO"],["7","ContiguousFile"],["g","GlobalExtendedHeader"],["x","ExtendedHeader"],["A","SolarisACL"],["D","GNUDumpDir"],["I","Inode"],["K","NextFileHasLongLinkpath"],["L","NextFileHasLongPath"],["M","ContinuationFile"],["N","OldGnuLongPath"],["S","SparseFile"],["V","TapeVolumeHeader"],["X","OldExtendedHeader"]]),e.code=new Map(Array.from(e.name).map((t=>[t[1],t[0]])))}));const ht=Symbol("slurp");var ot=class extends et{constructor(t,e,i){switch(super(),this.pause(),this.extended=e,this.globalExtended=i,this.header=t,this.startBlockSize=512*Math.ceil(t.size/512),this.blockRemain=this.startBlockSize,this.remain=t.size,this.type=t.type,this.meta=!1,this.ignore=!1,this.type){case"File":case"OldFile":case"Link":case"SymbolicLink":case"CharacterDevice":case"BlockDevice":case"Directory":case"FIFO":case"ContiguousFile":case"GNUDumpDir":break;case"NextFileHasLongLinkpath":case"NextFileHasLongPath":case"OldGnuLongPath":case"GlobalExtendedHeader":case"ExtendedHeader":case"OldExtendedHeader":this.meta=!0;break;default:this.ignore=!0}this.path=t.path,this.mode=t.mode,this.mode&&(this.mode=4095&this.mode),this.uid=t.uid,this.gid=t.gid,this.uname=t.uname,this.gname=t.gname,this.size=t.size,this.mtime=t.mtime,this.atime=t.atime,this.ctime=t.ctime,this.linkpath=t.linkpath,this.uname=t.uname,this.gname=t.gname,e&&this[ht](e),i&&this[ht](i,!0)}write(t){const e=t.length;if(e>this.blockRemain)throw new Error("writing more to entry than is appropriate");const i=this.remain,s=this.blockRemain;return this.remain=Math.max(0,i-e),this.blockRemain=Math.max(0,s-e),!!this.ignore||(i>=e?super.write(t):super.write(t.slice(0,i)))}[ht](t,e){for(let i in t)null===t[i]||void 0===t[i]||e&&"path"===i||(this[i]=t[i])}},at=O((function(t,e){e.encode=(t,e)=>{if(!Number.isSafeInteger(t))throw Error("cannot encode number outside of javascript safe integer range");return t<0?s(t,e):i(t,e),e};const i=(t,e)=>{e[0]=128;for(var i=e.length;i>1;i--)e[i-1]=255&t,t=Math.floor(t/256)},s=(t,e)=>{e[0]=255;var i=!1;t*=-1;for(var s=e.length;s>1;s--){var r=255&t;t=Math.floor(t/256),i?e[s-1]=h(r):0===r?e[s-1]=0:(i=!0,e[s-1]=o(r))}},r=(e.parse=t=>{t[t.length-1];var e,i=t[0];if(128===i)e=n(t.slice(1,t.length));else{if(255!==i)throw Error("invalid base256 encoding");e=r(t)}if(!Number.isSafeInteger(e))throw Error("parsed number outside of javascript safe integer range");return e},t=>{for(var e=t.length,i=0,s=!1,r=e-1;r>-1;r--){var n,a=t[r];s?n=h(a):0===a?n=a:(s=!0,n=o(a)),0!==n&&(i-=n*Math.pow(256,e-r-1))}return i}),n=t=>{for(var e=t.length,i=0,s=e-1;s>-1;s--){var r=t[s];0!==r&&(i+=r*Math.pow(256,e-s-1))}return i},h=t=>255&(255^t),o=t=>1+(255^t)&255}));const lt=d.default.posix,ut=Symbol("slurp"),ct=Symbol("type");const dt=(t,e)=>{const i=100;let s,r=t,n="";const h=lt.parse(t).root||".";if(Buffer.byteLength(r)<i)s=[r,n,!1];else{n=lt.dirname(r),r=lt.basename(r);do{Buffer.byteLength(r)<=i&&Buffer.byteLength(n)<=e?s=[r,n,!1]:Buffer.byteLength(r)>i&&Buffer.byteLength(n)<=e?s=[r.substr(0,99),n,!0]:(r=lt.join(lt.basename(n),r),n=lt.dirname(n))}while(n!==h&&!s);s||(s=[t.substr(0,99),"",!0])}return s},ft=(t,e,i)=>t.slice(e,e+i).toString("utf8").replace(/\0.*/,""),pt=(t,e,i)=>mt(yt(t,e,i)),mt=t=>null===t?null:new Date(1e3*t),yt=(t,e,i)=>128&t[e]?at.parse(t.slice(e,e+i)):bt(t,e,i),bt=(t,e,i)=>{return s=parseInt(t.slice(e,e+i).toString("utf8").replace(/\0.*$/,"").trim(),8),isNaN(s)?null:s;var s},wt={12:8589934591,8:2097151},Et=(t,e,i,s)=>null!==s&&(s>wt[i]||s<0?(at.encode(s,t.slice(e,e+i)),!0):(gt(t,e,i,s),!1)),gt=(t,e,i,s)=>t.write(_t(s,i),e,i,"ascii"),_t=(t,e)=>St(Math.floor(t).toString(8),e),St=(t,e)=>(t.length===e-1?t:new Array(e-t.length-1).join("0")+t+" ")+"\0",Rt=(t,e,i,s)=>null!==s&&Et(t,e,i,s.getTime()/1e3),Ot=new Array(156).join("\0"),vt=(t,e,i,s)=>null!==s&&(t.write(s+Ot,e,i,"utf8"),s.length!==Buffer.byteLength(s)||s.length>i);var Tt=class{constructor(t,e,i,s){this.cksumValid=!1,this.needPax=!1,this.nullBlock=!1,this.block=null,this.path=null,this.mode=null,this.uid=null,this.gid=null,this.size=null,this.mtime=null,this.cksum=null,this[ct]="0",this.linkpath=null,this.uname=null,this.gname=null,this.devmaj=0,this.devmin=0,this.atime=null,this.ctime=null,Buffer.isBuffer(t)?this.decode(t,e||0,i,s):t&&this.set(t)}decode(t,e,i,s){if(e||(e=0),!(t&&t.length>=e+512))throw new Error("need 512 bytes for header");if(this.path=ft(t,e,100),this.mode=yt(t,e+100,8),this.uid=yt(t,e+108,8),this.gid=yt(t,e+116,8),this.size=yt(t,e+124,12),this.mtime=pt(t,e+136,12),this.cksum=yt(t,e+148,12),this[ut](i),this[ut](s,!0),this[ct]=ft(t,e+156,1),""===this[ct]&&(this[ct]="0"),"0"===this[ct]&&"/"===this.path.substr(-1)&&(this[ct]="5"),"5"===this[ct]&&(this.size=0),this.linkpath=ft(t,e+157,100),"ustar\x0000"===t.slice(e+257,e+265).toString())if(this.uname=ft(t,e+265,32),this.gname=ft(t,e+297,32),this.devmaj=yt(t,e+329,8),this.devmin=yt(t,e+337,8),0!==t[e+475]){const i=ft(t,e+345,155);this.path=i+"/"+this.path}else{const i=ft(t,e+345,130);i&&(this.path=i+"/"+this.path),this.atime=pt(t,e+476,12),this.ctime=pt(t,e+488,12)}let r=256;for(let i=e;i<e+148;i++)r+=t[i];for(let i=e+156;i<e+512;i++)r+=t[i];this.cksumValid=r===this.cksum,null===this.cksum&&256===r&&(this.nullBlock=!0)}[ut](t,e){for(let i in t)null===t[i]||void 0===t[i]||e&&"path"===i||(this[i]=t[i])}encode(t,e){if(t||(t=this.block=Buffer.alloc(512),e=0),e||(e=0),!(t.length>=e+512))throw new Error("need 512 bytes for header");const i=this.ctime||this.atime?130:155,s=dt(this.path||"",i),r=s[0],n=s[1];this.needPax=s[2],this.needPax=vt(t,e,100,r)||this.needPax,this.needPax=Et(t,e+100,8,this.mode)||this.needPax,this.needPax=Et(t,e+108,8,this.uid)||this.needPax,this.needPax=Et(t,e+116,8,this.gid)||this.needPax,this.needPax=Et(t,e+124,12,this.size)||this.needPax,this.needPax=Rt(t,e+136,12,this.mtime)||this.needPax,t[e+156]=this[ct].charCodeAt(0),this.needPax=vt(t,e+157,100,this.linkpath)||this.needPax,t.write("ustar\x0000",e+257,8),this.needPax=vt(t,e+265,32,this.uname)||this.needPax,this.needPax=vt(t,e+297,32,this.gname)||this.needPax,this.needPax=Et(t,e+329,8,this.devmaj)||this.needPax,this.needPax=Et(t,e+337,8,this.devmin)||this.needPax,this.needPax=vt(t,e+345,i,n)||this.needPax,0!==t[e+475]?this.needPax=vt(t,e+345,155,n)||this.needPax:(this.needPax=vt(t,e+345,130,n)||this.needPax,this.needPax=Rt(t,e+476,12,this.atime)||this.needPax,this.needPax=Rt(t,e+488,12,this.ctime)||this.needPax);let h=256;for(let i=e;i<e+148;i++)h+=t[i];for(let i=e+156;i<e+512;i++)h+=t[i];return this.cksum=h,Et(t,e+148,8,this.cksum),this.cksumValid=!0,this.needPax}set(t){for(let e in t)null!==t[e]&&void 0!==t[e]&&(this[e]=t[e])}get type(){return nt.name.get(this[ct])||this[ct]}get typeKey(){return this[ct]}set type(t){nt.code.has(t)?this[ct]=nt.code.get(t):this[ct]=t}};class kt{constructor(t,e){this.atime=t.atime||null,this.charset=t.charset||null,this.comment=t.comment||null,this.ctime=t.ctime||null,this.gid=t.gid||null,this.gname=t.gname||null,this.linkpath=t.linkpath||null,this.mtime=t.mtime||null,this.path=t.path||null,this.size=t.size||null,this.uid=t.uid||null,this.uname=t.uname||null,this.dev=t.dev||null,this.ino=t.ino||null,this.nlink=t.nlink||null,this.global=e||!1}encode(){const t=this.encodeBody();if(""===t)return null;const e=Buffer.byteLength(t),i=512*Math.ceil(1+e/512),s=Buffer.allocUnsafe(i);for(let t=0;t<512;t++)s[t]=0;new Tt({path:("PaxHeader/"+d.default.basename(this.path)).slice(0,99),mode:this.mode||420,uid:this.uid||null,gid:this.gid||null,size:e,mtime:this.mtime||null,type:this.global?"GlobalExtendedHeader":"ExtendedHeader",linkpath:"",uname:this.uname||"",gname:this.gname||"",devmaj:0,devmin:0,atime:this.atime||null,ctime:this.ctime||null}).encode(s),s.write(t,512,e,"utf8");for(let t=e+512;t<s.length;t++)s[t]=0;return s}encodeBody(){return this.encodeField("path")+this.encodeField("ctime")+this.encodeField("atime")+this.encodeField("dev")+this.encodeField("ino")+this.encodeField("nlink")+this.encodeField("charset")+this.encodeField("comment")+this.encodeField("gid")+this.encodeField("gname")+this.encodeField("linkpath")+this.encodeField("mtime")+this.encodeField("size")+this.encodeField("uid")+this.encodeField("uname")}encodeField(t){if(null===this[t]||void 0===this[t])return"";const e=" "+("dev"===t||"ino"===t||"nlink"===t?"SCHILY.":"")+t+"="+(this[t]instanceof Date?this[t].getTime()/1e3:this[t])+"\n",i=Buffer.byteLength(e);let s=Math.floor(Math.log(i)/Math.log(10))+1;i+s>=Math.pow(10,s)&&(s+=1);return s+i+e}}kt.parse=(t,e,i)=>new kt(Lt(At(t),e),i);const Lt=(t,e)=>e?Object.keys(t).reduce(((e,i)=>(e[i]=t[i],e)),e):t,At=t=>t.replace(/\n$/,"").split("\n").reduce(It,Object.create(null)),It=(t,e)=>{const i=parseInt(e,10);if(i!==Buffer.byteLength(e)+1)return t;const s=(e=e.substr((i+" ").length)).split("="),r=s.shift().replace(/^SCHILY\.(dev|ino|nlink)/,"$1");if(!r)return t;const n=s.join("=");return t[r]=/^([A-Z]+\.)?([mac]|birth|creation)time$/.test(r)?new Date(1e3*n):/^[0-9]+$/.test(n)?+n:n,t};var Dt=kt,Nt=t=>class extends t{warn(t,e,i={}){this.file&&(i.file=this.file),this.cwd&&(i.cwd=this.cwd),i.code=e instanceof Error&&e.code||t,i.tarCode=t,this.strict||!1===i.recoverable?e instanceof Error?this.emit("error",Object.assign(e,i)):this.emit("error",Object.assign(new Error(`${t}: ${e}`),i)):(e instanceof Error&&(i=Object.assign(e,i),e=e.message),this.emit("warn",i.tarCode,e,i))}};const xt=["|","<",">","?",":"],Bt=xt.map((t=>String.fromCharCode(61440+t.charCodeAt(0)))),Mt=new Map(xt.map(((t,e)=>[t,Bt[e]]))),Ct=new Map(Bt.map(((t,e)=>[t,xt[e]])));var Ft=t=>xt.reduce(((t,e)=>t.split(e).join(Mt.get(e))),t),Pt=t=>Bt.reduce(((t,e)=>t.split(e).join(Ct.get(e))),t),zt=(t,e,i)=>(t&=4095,i&&(t=-19&(384|t)),e&&(256&t&&(t|=64),32&t&&(t|=8),4&t&&(t|=1)),t);const Ut=Symbol("process"),jt=Symbol("file"),Ht=Symbol("directory"),Gt=Symbol("symlink"),Zt=Symbol("hardlink"),Wt=Symbol("header"),Vt=Symbol("read"),Yt=Symbol("lstat"),$t=Symbol("onlstat"),qt=Symbol("onread"),Xt=Symbol("onreadlink"),Kt=Symbol("openfile"),Qt=Symbol("onopenfile"),Jt=Symbol("close"),te=Symbol("mode"),ee=Nt(class extends et{constructor(t,e){if(super(e=e||{}),"string"!=typeof t)throw new TypeError("path is required");this.path=t,this.portable=!!e.portable,this.myuid=process.getuid&&process.getuid(),this.myuser=process.env.USER||"",this.maxReadSize=e.maxReadSize||16777216,this.linkCache=e.linkCache||new Map,this.statCache=e.statCache||new Map,this.preservePaths=!!e.preservePaths,this.cwd=e.cwd||process.cwd(),this.strict=!!e.strict,this.noPax=!!e.noPax,this.noMtime=!!e.noMtime,this.mtime=e.mtime||null,"function"==typeof e.onwarn&&this.on("warn",e.onwarn);let i=!1;if(!this.preservePaths&&d.default.win32.isAbsolute(t)){const e=d.default.win32.parse(t);this.path=t.substr(e.root.length),i=e.root}this.win32=!!e.win32||"win32"===process.platform,this.win32&&(this.path=Pt(this.path.replace(/\\/g,"/")),t=t.replace(/\\/g,"/")),this.absolute=e.absolute||d.default.resolve(this.cwd,t),""===this.path&&(this.path="./"),i&&this.warn("TAR_ENTRY_INFO",`stripping ${i} from absolute path`,{entry:this,path:i+this.path}),this.statCache.has(this.absolute)?this[$t](this.statCache.get(this.absolute)):this[Yt]()}[Yt](){g.default.lstat(this.absolute,((t,e)=>{if(t)return this.emit("error",t);this[$t](e)}))}[$t](t){this.statCache.set(this.absolute,t),this.stat=t,t.isFile()||(t.size=0),this.type=se(t),this.emit("stat",t),this[Ut]()}[Ut](){switch(this.type){case"File":return this[jt]();case"Directory":return this[Ht]();case"SymbolicLink":return this[Gt]();default:return this.end()}}[te](t){return zt(t,"Directory"===this.type,this.portable)}[Wt](){"Directory"===this.type&&this.portable&&(this.noMtime=!0),this.header=new Tt({path:this.path,linkpath:this.linkpath,mode:this[te](this.stat.mode),uid:this.portable?null:this.stat.uid,gid:this.portable?null:this.stat.gid,size:this.stat.size,mtime:this.noMtime?null:this.mtime||this.stat.mtime,type:this.type,uname:this.portable?null:this.stat.uid===this.myuid?this.myuser:"",atime:this.portable?null:this.stat.atime,ctime:this.portable?null:this.stat.ctime}),this.header.encode()&&!this.noPax&&this.write(new Dt({atime:this.portable?null:this.header.atime,ctime:this.portable?null:this.header.ctime,gid:this.portable?null:this.header.gid,mtime:this.noMtime?null:this.mtime||this.header.mtime,path:this.path,linkpath:this.linkpath,size:this.header.size,uid:this.portable?null:this.header.uid,uname:this.portable?null:this.header.uname,dev:this.portable?null:this.stat.dev,ino:this.portable?null:this.stat.ino,nlink:this.portable?null:this.stat.nlink}).encode()),this.write(this.header.block)}[Ht](){"/"!==this.path.substr(-1)&&(this.path+="/"),this.stat.size=0,this[Wt](),this.end()}[Gt](){g.default.readlink(this.absolute,((t,e)=>{if(t)return this.emit("error",t);this[Xt](e)}))}[Xt](t){this.linkpath=t.replace(/\\/g,"/"),this[Wt](),this.end()}[Zt](t){this.type="Link",this.linkpath=d.default.relative(this.cwd,t).replace(/\\/g,"/"),this.stat.size=0,this[Wt](),this.end()}[jt](){if(this.stat.nlink>1){const t=this.stat.dev+":"+this.stat.ino;if(this.linkCache.has(t)){const e=this.linkCache.get(t);if(0===e.indexOf(this.cwd))return this[Zt](e)}this.linkCache.set(t,this.absolute)}if(this[Wt](),0===this.stat.size)return this.end();this[Kt]()}[Kt](){g.default.open(this.absolute,"r",((t,e)=>{if(t)return this.emit("error",t);this[Qt](e)}))}[Qt](t){const e=512*Math.ceil(this.stat.size/512),i=Math.min(e,this.maxReadSize),s=Buffer.allocUnsafe(i);this[Vt](t,s,0,s.length,0,this.stat.size,e)}[Vt](t,e,i,s,r,n,h){g.default.read(t,e,i,s,r,((o,a)=>{if(o)return this[Jt](t,(()=>this.emit("error",o)));this[qt](t,e,i,s,r,n,h,a)}))}[Jt](t,e){g.default.close(t,e)}[qt](t,e,i,s,r,n,h,o){if(o<=0&&n>0){const e=new Error("encountered unexpected EOF");return e.path=this.absolute,e.syscall="read",e.code="EOF",this[Jt](t,(()=>this.emit("error",e)))}if(o>n){const e=new Error("did not encounter expected EOF");return e.path=this.absolute,e.syscall="read",e.code="EOF",this[Jt](t,(()=>this.emit("error",e)))}if(o===n)for(let t=o;t<s&&o<h;t++)e[t+i]=0,o++,n++;const a=0===i&&o===e.length?e:e.slice(i,i+o);if(n-=o,h-=o,r+=o,i+=o,this.write(a),!n)return h&&this.write(Buffer.alloc(h)),this[Jt](t,(t=>t?this.emit("error",t):this.end()));i>=s&&(e=Buffer.allocUnsafe(s),i=0),s=e.length-i,this[Vt](t,e,i,s,r,n,h)}});const ie=Nt(class extends et{constructor(t,e){super(e=e||{}),this.preservePaths=!!e.preservePaths,this.portable=!!e.portable,this.strict=!!e.strict,this.noPax=!!e.noPax,this.noMtime=!!e.noMtime,this.readEntry=t,this.type=t.type,"Directory"===this.type&&this.portable&&(this.noMtime=!0),this.path=t.path,this.mode=this[te](t.mode),this.uid=this.portable?null:t.uid,this.gid=this.portable?null:t.gid,this.uname=this.portable?null:t.uname,this.gname=this.portable?null:t.gname,this.size=t.size,this.mtime=this.noMtime?null:e.mtime||t.mtime,this.atime=this.portable?null:t.atime,this.ctime=this.portable?null:t.ctime,this.linkpath=t.linkpath,"function"==typeof e.onwarn&&this.on("warn",e.onwarn);let i=!1;if(d.default.isAbsolute(this.path)&&!this.preservePaths){const t=d.default.parse(this.path);i=t.root,this.path=this.path.substr(t.root.length)}this.remain=t.size,this.blockRemain=t.startBlockSize,this.header=new Tt({path:this.path,linkpath:this.linkpath,mode:this.mode,uid:this.portable?null:this.uid,gid:this.portable?null:this.gid,size:this.size,mtime:this.noMtime?null:this.mtime,type:this.type,uname:this.portable?null:this.uname,atime:this.portable?null:this.atime,ctime:this.portable?null:this.ctime}),i&&this.warn("TAR_ENTRY_INFO",`stripping ${i} from absolute path`,{entry:this,path:i+this.path}),this.header.encode()&&!this.noPax&&super.write(new Dt({atime:this.portable?null:this.atime,ctime:this.portable?null:this.ctime,gid:this.portable?null:this.gid,mtime:this.noMtime?null:this.mtime,path:this.path,linkpath:this.linkpath,size:this.size,uid:this.portable?null:this.uid,uname:this.portable?null:this.uname,dev:this.portable?null:this.readEntry.dev,ino:this.portable?null:this.readEntry.ino,nlink:this.portable?null:this.readEntry.nlink}).encode()),super.write(this.header.block),t.pipe(this)}[te](t){return zt(t,"Directory"===this.type,this.portable)}write(t){const e=t.length;if(e>this.blockRemain)throw new Error("writing more to entry than is appropriate");return this.blockRemain-=e,super.write(t)}end(){return this.blockRemain&&this.write(Buffer.alloc(this.blockRemain)),super.end()}});ee.Sync=class extends ee{constructor(t,e){super(t,e)}[Yt](){this[$t](g.default.lstatSync(this.absolute))}[Gt](){this[Xt](g.default.readlinkSync(this.absolute))}[Kt](){this[Qt](g.default.openSync(this.absolute,"r"))}[Vt](t,e,i,s,r,n,h){let o=!0;try{const a=g.default.readSync(t,e,i,s,r);this[qt](t,e,i,s,r,n,h,a),o=!1}finally{if(o)try{this[Jt](t,(()=>{}))}catch(t){}}}[Jt](t,e){g.default.closeSync(t),e()}},ee.Tar=ie;const se=t=>t.isFile()?"File":t.isDirectory()?"Directory":t.isSymbolicLink()?"SymbolicLink":"Unsupported";var re=ee;class ne{constructor(t,e){this.path=t||"./",this.absolute=e,this.entry=null,this.stat=null,this.readdir=null,this.pending=!1,this.ignore=!1,this.piped=!1}}const he=re.Sync,oe=re.Tar,ae=Buffer.alloc(1024),le=Symbol("onStat"),ue=Symbol("ended"),ce=Symbol("queue"),de=Symbol("current"),fe=Symbol("process"),pe=Symbol("processing"),me=Symbol("processJob"),ye=Symbol("jobs"),be=Symbol("jobDone"),we=Symbol("addFSEntry"),Ee=Symbol("addTarEntry"),ge=Symbol("stat"),_e=Symbol("readdir"),Se=Symbol("onreaddir"),Re=Symbol("pipe"),Oe=Symbol("entry"),ve=Symbol("entryOpt"),Te=Symbol("writeEntryClass"),ke=Symbol("write"),Le=Symbol("ondrain"),Ae=Nt(class extends et{constructor(t){super(t),t=t||Object.create(null),this.opt=t,this.file=t.file||"",this.cwd=t.cwd||process.cwd(),this.maxReadSize=t.maxReadSize,this.preservePaths=!!t.preservePaths,this.strict=!!t.strict,this.noPax=!!t.noPax,this.prefix=(t.prefix||"").replace(/(\\|\/)+$/,""),this.linkCache=t.linkCache||new Map,this.statCache=t.statCache||new Map,this.readdirCache=t.readdirCache||new Map,this[Te]=re,"function"==typeof t.onwarn&&this.on("warn",t.onwarn),this.portable=!!t.portable,this.zip=null,t.gzip?("object"!=typeof t.gzip&&(t.gzip={}),this.portable&&(t.gzip.portable=!0),this.zip=new rt.Gzip(t.gzip),this.zip.on("data",(t=>super.write(t))),this.zip.on("end",(t=>super.end())),this.zip.on("drain",(t=>this[Le]())),this.on("resume",(t=>this.zip.resume()))):this.on("drain",this[Le]),this.noDirRecurse=!!t.noDirRecurse,this.follow=!!t.follow,this.noMtime=!!t.noMtime,this.mtime=t.mtime||null,this.filter="function"==typeof t.filter?t.filter:t=>!0,this[ce]=new T,this[ye]=0,this.jobs=+t.jobs||4,this[pe]=!1,this[ue]=!1}[ke](t){return super.write(t)}add(t){return this.write(t),this}end(t){return t&&this.write(t),this[ue]=!0,this[fe](),this}write(t){if(this[ue])throw new Error("write after end");return t instanceof ot?this[Ee](t):this[we](t),this.flowing}[Ee](t){const e=d.default.resolve(this.cwd,t.path);if(this.prefix&&(t.path=this.prefix+"/"+t.path.replace(/^\.(\/+|$)/,"")),this.filter(t.path,t)){const i=new ne(t.path,e,!1);i.entry=new oe(t,this[ve](i)),i.entry.on("end",(t=>this[be](i))),this[ye]+=1,this[ce].push(i)}else t.resume();this[fe]()}[we](t){const e=d.default.resolve(this.cwd,t);this.prefix&&(t=this.prefix+"/"+t.replace(/^\.(\/+|$)/,"")),this[ce].push(new ne(t,e)),this[fe]()}[ge](t){t.pending=!0,this[ye]+=1;const e=this.follow?"stat":"lstat";g.default[e](t.absolute,((e,i)=>{t.pending=!1,this[ye]-=1,e?this.emit("error",e):this[le](t,i)}))}[le](t,e){this.statCache.set(t.absolute,e),t.stat=e,this.filter(t.path,e)||(t.ignore=!0),this[fe]()}[_e](t){t.pending=!0,this[ye]+=1,g.default.readdir(t.absolute,((e,i)=>{if(t.pending=!1,this[ye]-=1,e)return this.emit("error",e);this[Se](t,i)}))}[Se](t,e){this.readdirCache.set(t.absolute,e),t.readdir=e,this[fe]()}[fe](){if(!this[pe]){this[pe]=!0;for(let t=this[ce].head;null!==t&&this[ye]<this.jobs;t=t.next)if(this[me](t.value),t.value.ignore){const e=t.next;this[ce].removeNode(t),t.next=e}this[pe]=!1,this[ue]&&!this[ce].length&&0===this[ye]&&(this.zip?this.zip.end(ae):(super.write(ae),super.end()))}}get[de](){return this[ce]&&this[ce].head&&this[ce].head.value}[be](t){this[ce].shift(),this[ye]-=1,this[fe]()}[me](t){t.pending||(t.entry?t!==this[de]||t.piped||this[Re](t):(t.stat||(this.statCache.has(t.absolute)?this[le](t,this.statCache.get(t.absolute)):this[ge](t)),t.stat&&(t.ignore||(this.noDirRecurse||!t.stat.isDirectory()||t.readdir||(this.readdirCache.has(t.absolute)?this[Se](t,this.readdirCache.get(t.absolute)):this[_e](t),t.readdir))&&(t.entry=this[Oe](t),t.entry?t!==this[de]||t.piped||this[Re](t):t.ignore=!0))))}[ve](t){return{onwarn:(t,e,i)=>this.warn(t,e,i),noPax:this.noPax,cwd:this.cwd,absolute:t.absolute,preservePaths:this.preservePaths,maxReadSize:this.maxReadSize,strict:this.strict,portable:this.portable,linkCache:this.linkCache,statCache:this.statCache,noMtime:this.noMtime,mtime:this.mtime}}[Oe](t){this[ye]+=1;try{return new this[Te](t.path,this[ve](t)).on("end",(()=>this[be](t))).on("error",(t=>this.emit("error",t)))}catch(t){this.emit("error",t)}}[Le](){this[de]&&this[de].entry&&this[de].entry.resume()}[Re](t){t.piped=!0,t.readdir&&t.readdir.forEach((e=>{const i=this.prefix?t.path.slice(this.prefix.length+1)||"./":t.path,s="./"===i?"":i.replace(/\/*$/,"/");this[we](s+e)}));const e=t.entry,i=this.zip;i?e.on("data",(t=>{i.write(t)||e.pause()})):e.on("data",(t=>{super.write(t)||e.pause()}))}pause(){return this.zip&&this.zip.pause(),super.pause()}});Ae.Sync=class extends Ae{constructor(t){super(t),this[Te]=he}pause(){}resume(){}[ge](t){const e=this.follow?"statSync":"lstatSync";this[le](t,g.default[e](t.absolute))}[_e](t,e){this[Se](t,g.default.readdirSync(t.absolute))}[Re](t){const e=t.entry,i=this.zip;t.readdir&&t.readdir.forEach((e=>{const i=this.prefix?t.path.slice(this.prefix.length+1)||"./":t.path,s="./"===i?"":i.replace(/\/*$/,"/");this[we](s+e)})),i?e.on("data",(t=>{i.write(t)})):e.on("data",(t=>{super[ke](t)}))}};var Ie=Ae;const De=p.default.EventEmitter;let Ne=g.default.writev;if(!Ne){const t=process.binding("fs"),e=t.FSReqWrap||t.FSReqCallback;Ne=(i,s,r,n)=>{const h=new e;h.oncomplete=(t,e)=>n(t,e,s),t.writeBuffers(i,s,r,h)}}const xe=Symbol("_autoClose"),Be=Symbol("_close"),Me=Symbol("_ended"),Ce=Symbol("_fd"),Fe=Symbol("_finished"),Pe=Symbol("_flags"),ze=Symbol("_flush"),Ue=Symbol("_handleChunk"),je=Symbol("_makeBuf"),He=Symbol("_mode"),Ge=Symbol("_needDrain"),Ze=Symbol("_onerror"),We=Symbol("_onopen"),Ve=Symbol("_onread"),Ye=Symbol("_onwrite"),$e=Symbol("_open"),qe=Symbol("_path"),Xe=Symbol("_pos"),Ke=Symbol("_queue"),Qe=Symbol("_read"),Je=Symbol("_readSize"),ti=Symbol("_reading"),ei=Symbol("_remain"),ii=Symbol("_size"),si=Symbol("_write"),ri=Symbol("_writing"),ni=Symbol("_defaultFlag"),hi=Symbol("_errored");class oi extends et{constructor(t,e){if(super(e=e||{}),this.readable=!0,this.writable=!1,"string"!=typeof t)throw new TypeError("path must be a string");this[hi]=!1,this[Ce]="number"==typeof e.fd?e.fd:null,this[qe]=t,this[Je]=e.readSize||16777216,this[ti]=!1,this[ii]="number"==typeof e.size?e.size:1/0,this[ei]=this[ii],this[xe]="boolean"!=typeof e.autoClose||e.autoClose,"number"==typeof this[Ce]?this[Qe]():this[$e]()}get fd(){return this[Ce]}get path(){return this[qe]}write(){throw new TypeError("this is a readable stream")}end(){throw new TypeError("this is a readable stream")}[$e](){g.default.open(this[qe],"r",((t,e)=>this[We](t,e)))}[We](t,e){t?this[Ze](t):(this[Ce]=e,this.emit("open",e),this[Qe]())}[je](){return Buffer.allocUnsafe(Math.min(this[Je],this[ei]))}[Qe](){if(!this[ti]){this[ti]=!0;const t=this[je]();if(0===t.length)return process.nextTick((()=>this[Ve](null,0,t)));g.default.read(this[Ce],t,0,t.length,null,((t,e,i)=>this[Ve](t,e,i)))}}[Ve](t,e,i){this[ti]=!1,t?this[Ze](t):this[Ue](e,i)&&this[Qe]()}[Be](){if(this[xe]&&"number"==typeof this[Ce]){const t=this[Ce];this[Ce]=null,g.default.close(t,(t=>t?this.emit("error",t):this.emit("close")))}}[Ze](t){this[ti]=!0,this[Be](),this.emit("error",t)}[Ue](t,e){let i=!1;return this[ei]-=t,t>0&&(i=super.write(t<e.length?e.slice(0,t):e)),(0===t||this[ei]<=0)&&(i=!1,this[Be](),super.end()),i}emit(t,e){switch(t){case"prefinish":case"finish":break;case"drain":"number"==typeof this[Ce]&&this[Qe]();break;case"error":if(this[hi])return;return this[hi]=!0,super.emit(t,e);default:return super.emit(t,e)}}}class ai extends De{constructor(t,e){super(e=e||{}),this.readable=!1,this.writable=!0,this[hi]=!1,this[ri]=!1,this[Me]=!1,this[Ge]=!1,this[Ke]=[],this[qe]=t,this[Ce]="number"==typeof e.fd?e.fd:null,this[He]=void 0===e.mode?438:e.mode,this[Xe]="number"==typeof e.start?e.start:null,this[xe]="boolean"!=typeof e.autoClose||e.autoClose;const i=null!==this[Xe]?"r+":"w";this[ni]=void 0===e.flags,this[Pe]=this[ni]?i:e.flags,null===this[Ce]&&this[$e]()}emit(t,e){if("error"===t){if(this[hi])return;this[hi]=!0}return super.emit(t,e)}get fd(){return this[Ce]}get path(){return this[qe]}[Ze](t){this[Be](),this[ri]=!0,this.emit("error",t)}[$e](){g.default.open(this[qe],this[Pe],this[He],((t,e)=>this[We](t,e)))}[We](t,e){this[ni]&&"r+"===this[Pe]&&t&&"ENOENT"===t.code?(this[Pe]="w",this[$e]()):t?this[Ze](t):(this[Ce]=e,this.emit("open",e),this[ze]())}end(t,e){return t&&this.write(t,e),this[Me]=!0,this[ri]||this[Ke].length||"number"!=typeof this[Ce]||this[Ye](null,0),this}write(t,e){return"string"==typeof t&&(t=Buffer.from(t,e)),this[Me]?(this.emit("error",new Error("write() after end()")),!1):null===this[Ce]||this[ri]||this[Ke].length?(this[Ke].push(t),this[Ge]=!0,!1):(this[ri]=!0,this[si](t),!0)}[si](t){g.default.write(this[Ce],t,0,t.length,this[Xe],((t,e)=>this[Ye](t,e)))}[Ye](t,e){t?this[Ze](t):(null!==this[Xe]&&(this[Xe]+=e),this[Ke].length?this[ze]():(this[ri]=!1,this[Me]&&!this[Fe]?(this[Fe]=!0,this[Be](),this.emit("finish")):this[Ge]&&(this[Ge]=!1,this.emit("drain"))))}[ze](){if(0===this[Ke].length)this[Me]&&this[Ye](null,0);else if(1===this[Ke].length)this[si](this[Ke].pop());else{const t=this[Ke];this[Ke]=[],Ne(this[Ce],t,this[Xe],((t,e)=>this[Ye](t,e)))}}[Be](){if(this[xe]&&"number"==typeof this[Ce]){const t=this[Ce];this[Ce]=null,g.default.close(t,(t=>t?this.emit("error",t):this.emit("close")))}}}var li={ReadStream:oi,ReadStreamSync:class extends oi{[$e](){let t=!0;try{this[We](null,g.default.openSync(this[qe],"r")),t=!1}finally{t&&this[Be]()}}[Qe](){let t=!0;try{if(!this[ti]){for(this[ti]=!0;;){const t=this[je](),e=0===t.length?0:g.default.readSync(this[Ce],t,0,t.length,null);if(!this[Ue](e,t))break}this[ti]=!1}t=!1}finally{t&&this[Be]()}}[Be](){if(this[xe]&&"number"==typeof this[Ce]){const t=this[Ce];this[Ce]=null,g.default.closeSync(t),this.emit("close")}}},WriteStream:ai,WriteStreamSync:class extends ai{[$e](){let t;if(this[ni]&&"r+"===this[Pe])try{t=g.default.openSync(this[qe],this[Pe],this[He])}catch(t){if("ENOENT"===t.code)return this[Pe]="w",this[$e]();throw t}else t=g.default.openSync(this[qe],this[Pe],this[He]);this[We](null,t)}[Be](){if(this[xe]&&"number"==typeof this[Ce]){const t=this[Ce];this[Ce]=null,g.default.closeSync(t),this.emit("close")}}[si](t){let e=!0;try{this[Ye](null,g.default.writeSync(this[Ce],t,0,t.length,this[Xe])),e=!1}finally{if(e)try{this[Be]()}catch(t){}}}}};const ui=Buffer.from([31,139]),ci=Symbol("state"),di=Symbol("writeEntry"),fi=Symbol("readEntry"),pi=Symbol("nextEntry"),mi=Symbol("processEntry"),yi=Symbol("extendedHeader"),bi=Symbol("globalExtendedHeader"),wi=Symbol("meta"),Ei=Symbol("emitMeta"),gi=Symbol("buffer"),_i=Symbol("queue"),Si=Symbol("ended"),Ri=Symbol("emittedEnd"),Oi=Symbol("emit"),vi=Symbol("unzip"),Ti=Symbol("consumeChunk"),ki=Symbol("consumeChunkSub"),Li=Symbol("consumeBody"),Ai=Symbol("consumeMeta"),Ii=Symbol("consumeHeader"),Di=Symbol("consuming"),Ni=Symbol("bufferConcat"),xi=Symbol("maybeEnd"),Bi=Symbol("writing"),Mi=Symbol("aborted"),Ci=Symbol("onDone"),Fi=Symbol("sawValidEntry"),Pi=Symbol("sawNullBlock"),zi=Symbol("sawEOF"),Ui=t=>!0;var ji=Nt(class extends p.default{constructor(t){super(t=t||{}),this.file=t.file||"",this[Fi]=null,this.on(Ci,(t=>{"begin"!==this[ci]&&!1!==this[Fi]||this.warn("TAR_BAD_ARCHIVE","Unrecognized archive format")})),t.ondone?this.on(Ci,t.ondone):this.on(Ci,(t=>{this.emit("prefinish"),this.emit("finish"),this.emit("end"),this.emit("close")})),this.strict=!!t.strict,this.maxMetaEntrySize=t.maxMetaEntrySize||1048576,this.filter="function"==typeof t.filter?t.filter:Ui,this.writable=!0,this.readable=!1,this[_i]=new T,this[gi]=null,this[fi]=null,this[di]=null,this[ci]="begin",this[wi]="",this[yi]=null,this[bi]=null,this[Si]=!1,this[vi]=null,this[Mi]=!1,this[Pi]=!1,this[zi]=!1,"function"==typeof t.onwarn&&this.on("warn",t.onwarn),"function"==typeof t.onentry&&this.on("entry",t.onentry)}[Ii](t,e){let i;null===this[Fi]&&(this[Fi]=!1);try{i=new Tt(t,e,this[yi],this[bi])}catch(t){return this.warn("TAR_ENTRY_INVALID",t)}if(i.nullBlock)this[Pi]?(this[zi]=!0,"begin"===this[ci]&&(this[ci]="header"),this[Oi]("eof")):(this[Pi]=!0,this[Oi]("nullBlock"));else if(this[Pi]=!1,i.cksumValid)if(i.path){const t=i.type;if(/^(Symbolic)?Link$/.test(t)&&!i.linkpath)this.warn("TAR_ENTRY_INVALID","linkpath required",{header:i});else if(!/^(Symbolic)?Link$/.test(t)&&i.linkpath)this.warn("TAR_ENTRY_INVALID","linkpath forbidden",{header:i});else{const t=this[di]=new ot(i,this[yi],this[bi]);if(!this[Fi])if(t.remain){const e=()=>{t.invalid||(this[Fi]=!0)};t.on("end",e)}else this[Fi]=!0;t.meta?t.size>this.maxMetaEntrySize?(t.ignore=!0,this[Oi]("ignoredEntry",t),this[ci]="ignore",t.resume()):t.size>0&&(this[wi]="",t.on("data",(t=>this[wi]+=t)),this[ci]="meta"):(this[yi]=null,t.ignore=t.ignore||!this.filter(t.path,t),t.ignore?(this[Oi]("ignoredEntry",t),this[ci]=t.remain?"ignore":"header",t.resume()):(t.remain?this[ci]="body":(this[ci]="header",t.end()),this[fi]?this[_i].push(t):(this[_i].push(t),this[pi]())))}}else this.warn("TAR_ENTRY_INVALID","path is required",{header:i});else this.warn("TAR_ENTRY_INVALID","checksum failure",{header:i})}[mi](t){let e=!0;return t?Array.isArray(t)?this.emit.apply(this,t):(this[fi]=t,this.emit("entry",t),t.emittedEnd||(t.on("end",(t=>this[pi]())),e=!1)):(this[fi]=null,e=!1),e}[pi](){do{}while(this[mi](this[_i].shift()));if(!this[_i].length){const t=this[fi];!t||t.flowing||t.size===t.remain?this[Bi]||this.emit("drain"):t.once("drain",(t=>this.emit("drain")))}}[Li](t,e){const i=this[di],s=i.blockRemain,r=s>=t.length&&0===e?t:t.slice(e,e+s);return i.write(r),i.blockRemain||(this[ci]="header",this[di]=null,i.end()),r.length}[Ai](t,e){const i=this[di],s=this[Li](t,e);return this[di]||this[Ei](i),s}[Oi](t,e,i){this[_i].length||this[fi]?this[_i].push([t,e,i]):this.emit(t,e,i)}[Ei](t){switch(this[Oi]("meta",this[wi]),t.type){case"ExtendedHeader":case"OldExtendedHeader":this[yi]=Dt.parse(this[wi],this[yi],!1);break;case"GlobalExtendedHeader":this[bi]=Dt.parse(this[wi],this[bi],!0);break;case"NextFileHasLongPath":case"OldGnuLongPath":this[yi]=this[yi]||Object.create(null),this[yi].path=this[wi].replace(/\0.*/,"");break;case"NextFileHasLongLinkpath":this[yi]=this[yi]||Object.create(null),this[yi].linkpath=this[wi].replace(/\0.*/,"");break;default:throw new Error("unknown meta: "+t.type)}}abort(t){this[Mi]=!0,this.emit("abort",t),this.warn("TAR_ABORT",t,{recoverable:!1})}write(t){if(this[Mi])return;if(null===this[vi]&&t){if(this[gi]&&(t=Buffer.concat([this[gi],t]),this[gi]=null),t.length<ui.length)return this[gi]=t,!0;for(let e=0;null===this[vi]&&e<ui.length;e++)t[e]!==ui[e]&&(this[vi]=!1);if(null===this[vi]){const e=this[Si];this[Si]=!1,this[vi]=new rt.Unzip,this[vi].on("data",(t=>this[Ti](t))),this[vi].on("error",(t=>this.abort(t))),this[vi].on("end",(t=>{this[Si]=!0,this[Ti]()})),this[Bi]=!0;const i=this[vi][e?"end":"write"](t);return this[Bi]=!1,i}}this[Bi]=!0,this[vi]?this[vi].write(t):this[Ti](t),this[Bi]=!1;const e=!this[_i].length&&(!this[fi]||this[fi].flowing);return e||this[_i].length||this[fi].once("drain",(t=>this.emit("drain"))),e}[Ni](t){t&&!this[Mi]&&(this[gi]=this[gi]?Buffer.concat([this[gi],t]):t)}[xi](){if(this[Si]&&!this[Ri]&&!this[Mi]&&!this[Di]){this[Ri]=!0;const t=this[di];if(t&&t.blockRemain){const e=this[gi]?this[gi].length:0;this.warn("TAR_BAD_ARCHIVE",`Truncated input (needed ${t.blockRemain} more bytes, only ${e} available)`,{entry:t}),this[gi]&&t.write(this[gi]),t.end()}this[Oi](Ci)}}[Ti](t){if(this[Di])this[Ni](t);else if(t||this[gi]){if(this[Di]=!0,this[gi]){this[Ni](t);const e=this[gi];this[gi]=null,this[ki](e)}else this[ki](t);for(;this[gi]&&this[gi].length>=512&&!this[Mi]&&!this[zi];){const t=this[gi];this[gi]=null,this[ki](t)}this[Di]=!1}else this[xi]();this[gi]&&!this[Si]||this[xi]()}[ki](t){let e=0,i=t.length;for(;e+512<=i&&!this[Mi]&&!this[zi];)switch(this[ci]){case"begin":case"header":this[Ii](t,e),e+=512;break;case"ignore":case"body":e+=this[Li](t,e);break;case"meta":e+=this[Ai](t,e);break;default:throw new Error("invalid state: "+this[ci])}e<i&&(this[gi]?this[gi]=Buffer.concat([t.slice(e),this[gi]]):this[gi]=t.slice(e))}end(t){this[Mi]||(this[vi]?this[vi].end(t):(this[Si]=!0,this.write(t)))}}),Hi=O((function(t){t.exports=(t,h,o)=>{"function"==typeof t?(o=t,h=null,t={}):Array.isArray(t)&&(h=t,t={}),"function"==typeof h&&(o=h,h=null),h=h?Array.from(h):[];const a=v(t);if(a.sync&&"function"==typeof o)throw new TypeError("callback not supported for sync tar functions");if(!a.file&&"function"==typeof o)throw new TypeError("callback only supported with file option");return h.length&&i(a,h),a.noResume||e(a),a.file&&a.sync?s(a):a.file?r(a,o):n(a)};const e=t=>{const e=t.onentry;t.onentry=e?t=>{e(t),t.resume()}:t=>t.resume()},i=(t,e)=>{const i=new Map(e.map((t=>[t.replace(/\/+$/,""),!0]))),s=t.filter,r=(t,e)=>{const s=e||d.default.parse(t).root||".",n=t!==s&&(i.has(t)?i.get(t):r(d.default.dirname(t),s));return i.set(t,n),n};t.filter=s?(t,e)=>s(t,e)&&r(t.replace(/\/+$/,"")):t=>r(t.replace(/\/+$/,""))},s=t=>{const e=n(t),i=t.file;let s,r=!0;try{const n=g.default.statSync(i),h=t.maxReadSize||16777216;if(n.size<h)e.end(g.default.readFileSync(i));else{let t=0;const r=Buffer.allocUnsafe(h);for(s=g.default.openSync(i,"r");t<n.size;){let i=g.default.readSync(s,r,0,h,t);t+=i,e.write(r.slice(0,i))}e.end()}r=!1}finally{if(r&&s)try{g.default.closeSync(s)}catch(t){}}},r=(t,e)=>{const i=new ji(t),s=t.maxReadSize||16777216,r=t.file,n=new Promise(((t,e)=>{i.on("error",e),i.on("end",t),g.default.stat(r,((t,n)=>{if(t)e(t);else{const t=new li.ReadStream(r,{readSize:s,size:n.size});t.on("error",e),t.pipe(i)}}))}));return e?n.then(e,e):n},n=t=>new ji(t)})),Gi=O((function(t){t.exports=(t,s,r)=>{if("function"==typeof s&&(r=s),Array.isArray(t)&&(s=t,t={}),!s||!Array.isArray(s)||!s.length)throw new TypeError("no files or directories specified");s=Array.from(s);const o=v(t);if(o.sync&&"function"==typeof r)throw new TypeError("callback not supported for sync tar functions");if(!o.file&&"function"==typeof r)throw new TypeError("callback only supported with file option");return o.file&&o.sync?e(o,s):o.file?i(o,s,r):o.sync?n(o,s):h(o,s)};const e=(t,e)=>{const i=new Ie.Sync(t),r=new li.WriteStreamSync(t.file,{mode:t.mode||438});i.pipe(r),s(i,e)},i=(t,e,i)=>{const s=new Ie(t),n=new li.WriteStream(t.file,{mode:t.mode||438});s.pipe(n);const h=new Promise(((t,e)=>{n.on("error",e),n.on("close",t),s.on("error",e)}));return r(s,e),i?h.then(i,i):h},s=(t,e)=>{e.forEach((e=>{"@"===e.charAt(0)?Hi({file:d.default.resolve(t.cwd,e.substr(1)),sync:!0,noResume:!0,onentry:e=>t.add(e)}):t.add(e)})),t.end()},r=(t,e)=>{for(;e.length;){const i=e.shift();if("@"===i.charAt(0))return Hi({file:d.default.resolve(t.cwd,i.substr(1)),noResume:!0,onentry:e=>t.add(e)}).then((i=>r(t,e)));t.add(i)}t.end()},n=(t,e)=>{const i=new Ie.Sync(t);return s(i,e),i},h=(t,e)=>{const i=new Ie(t);return r(i,e),i}})),Zi=O((function(t){t.exports=(t,i,r)=>{const n=v(t);if(!n.file)throw new TypeError("file is required");if(n.gzip)throw new TypeError("cannot append to compressed archives");if(!i||!Array.isArray(i)||!i.length)throw new TypeError("no files or directories specified");return i=Array.from(i),n.sync?e(n,i):s(n,i,r)};const e=(t,e)=>{const s=new Ie.Sync(t);let r,n,h=!0;try{try{r=g.default.openSync(t.file,"r+")}catch(e){if("ENOENT"!==e.code)throw e;r=g.default.openSync(t.file,"w+")}const o=g.default.fstatSync(r),a=Buffer.alloc(512);t:for(n=0;n<o.size;n+=512){for(let t=0,e=0;t<512;t+=e){if(e=g.default.readSync(r,a,t,a.length-t,n+t),0===n&&31===a[0]&&139===a[1])throw new Error("cannot append to compressed archives");if(!e)break t}let e=new Tt(a);if(!e.cksumValid)break;let i=512*Math.ceil(e.size/512);if(n+i+512>o.size)break;n+=i,t.mtimeCache&&t.mtimeCache.set(e.path,e.mtime)}h=!1,i(t,s,n,r,e)}finally{if(h)try{g.default.closeSync(r)}catch(t){}}},i=(t,e,i,s,n)=>{const h=new li.WriteStreamSync(t.file,{fd:s,start:i});e.pipe(h),r(e,n)},s=(t,e,i)=>{e=Array.from(e);const s=new Ie(t),r=new Promise(((i,r)=>{s.on("error",r);let h="r+";const o=(a,l)=>a&&"ENOENT"===a.code&&"r+"===h?(h="w+",g.default.open(t.file,h,o)):a?r(a):void g.default.fstat(l,((h,o)=>{if(h)return r(h);((e,i,s)=>{const r=(t,i)=>{t?g.default.close(e,(e=>s(t))):s(null,i)};let n=0;if(0===i)return r(null,0);let h=0;const o=Buffer.alloc(512),a=(s,l)=>{if(s)return r(s);if(h+=l,h<512&&l)return g.default.read(e,o,h,o.length-h,n+h,a);if(0===n&&31===o[0]&&139===o[1])return r(new Error("cannot append to compressed archives"));if(h<512)return r(null,n);const u=new Tt(o);if(!u.cksumValid)return r(null,n);const c=512*Math.ceil(u.size/512);return n+c+512>i?r(null,n):(n+=c+512,n>=i?r(null,n):(t.mtimeCache&&t.mtimeCache.set(u.path,u.mtime),h=0,void g.default.read(e,o,0,512,n,a)))};g.default.read(e,o,0,512,n,a)})(l,o.size,((h,o)=>{if(h)return r(h);const a=new li.WriteStream(t.file,{fd:l,start:o});s.pipe(a),a.on("error",r),a.on("close",i),n(s,e)}))}));g.default.open(t.file,h,o)}));return i?r.then(i,i):r},r=(t,e)=>{e.forEach((e=>{"@"===e.charAt(0)?Hi({file:d.default.resolve(t.cwd,e.substr(1)),sync:!0,noResume:!0,onentry:e=>t.add(e)}):t.add(e)})),t.end()},n=(t,e)=>{for(;e.length;){const i=e.shift();if("@"===i.charAt(0))return Hi({file:d.default.resolve(t.cwd,i.substr(1)),noResume:!0,onentry:e=>t.add(e)}).then((i=>n(t,e)));t.add(i)}t.end()}})),Wi=O((function(t){t.exports=(t,i,s)=>{const r=v(t);if(!r.file)throw new TypeError("file is required");if(r.gzip)throw new TypeError("cannot append to compressed archives");if(!i||!Array.isArray(i)||!i.length)throw new TypeError("no files or directories specified");return i=Array.from(i),e(r),Zi(r,i,s)};const e=t=>{const e=t.filter;t.mtimeCache||(t.mtimeCache=new Map),t.filter=e?(i,s)=>e(i,s)&&!(t.mtimeCache.get(i)>s.mtime):(e,i)=>!(t.mtimeCache.get(e)>i.mtime)}}));const{promisify:Vi}=_.default;var Yi=t=>{if(t)if("object"==typeof t)t={mode:511,fs:g.default,...t};else if("number"==typeof t)t={mode:t,fs:g.default};else{if("string"!=typeof t)throw new TypeError("invalid options argument");t={mode:parseInt(t,8),fs:g.default}}else t={mode:511,fs:g.default};return t.mkdir=t.mkdir||t.fs.mkdir||g.default.mkdir,t.mkdirAsync=Vi(t.mkdir),t.stat=t.stat||t.fs.stat||g.default.stat,t.statAsync=Vi(t.stat),t.statSync=t.statSync||t.fs.statSync||g.default.statSync,t.mkdirSync=t.mkdirSync||t.fs.mkdirSync||g.default.mkdirSync,t};const $i=process.env.__TESTING_MKDIRP_PLATFORM__||process.platform,{resolve:qi,parse:Xi}=d.default;var Ki=t=>{if(/\0/.test(t))throw Object.assign(new TypeError("path must be a string without null bytes"),{path:t,code:"ERR_INVALID_ARG_VALUE"});if(t=qi(t),"win32"===$i){const e=/[*|"<>?:]/,{root:i}=Xi(t);if(e.test(t.substr(i.length)))throw Object.assign(new Error("Illegal characters in path."),{path:t,code:"EINVAL"})}return t};const{dirname:Qi}=d.default,Ji=(t,e,i)=>i===e?Promise.resolve():t.statAsync(e).then((t=>t.isDirectory()?i:void 0),(i=>"ENOENT"===i.code?Ji(t,Qi(e),e):void 0)),ts=(t,e,i)=>{if(i!==e)try{return t.statSync(e).isDirectory()?i:void 0}catch(i){return"ENOENT"===i.code?ts(t,Qi(e),e):void 0}};var es={findMade:Ji,findMadeSync:ts};const{dirname:is}=d.default,ss=(t,e,i)=>{e.recursive=!1;const s=is(t);return s===t?e.mkdirAsync(t,e).catch((t=>{if("EISDIR"!==t.code)throw t})):e.mkdirAsync(t,e).then((()=>i||t),(r=>{if("ENOENT"===r.code)return ss(s,e).then((i=>ss(t,e,i)));if("EEXIST"!==r.code&&"EROFS"!==r.code)throw r;return e.statAsync(t).then((t=>{if(t.isDirectory())return i;throw r}),(()=>{throw r}))}))},rs=(t,e,i)=>{const s=is(t);if(e.recursive=!1,s===t)try{return e.mkdirSync(t,e)}catch(t){if("EISDIR"!==t.code)throw t;return}try{return e.mkdirSync(t,e),i||t}catch(r){if("ENOENT"===r.code)return rs(t,e,rs(s,e,i));if("EEXIST"!==r.code&&"EROFS"!==r.code)throw r;try{if(!e.statSync(t).isDirectory())throw r}catch(t){throw r}}};var ns={mkdirpManual:ss,mkdirpManualSync:rs};const{dirname:hs}=d.default,{findMade:os,findMadeSync:as}=es,{mkdirpManual:ls,mkdirpManualSync:us}=ns;var cs={mkdirpNative:(t,e)=>{e.recursive=!0;return hs(t)===t?e.mkdirAsync(t,e):os(e,t).then((i=>e.mkdirAsync(t,e).then((()=>i)).catch((i=>{if("ENOENT"===i.code)return ls(t,e);throw i}))))},mkdirpNativeSync:(t,e)=>{e.recursive=!0;if(hs(t)===t)return e.mkdirSync(t,e);const i=as(e,t);try{return e.mkdirSync(t,e),i}catch(i){if("ENOENT"===i.code)return us(t,e);throw i}}};const ds=(process.env.__TESTING_MKDIRP_NODE_VERSION__||process.version).replace(/^v/,"").split("."),fs=+ds[0]>10||10==+ds[0]&&+ds[1]>=12;var ps={useNative:fs?t=>t.mkdir===g.default.mkdir:()=>!1,useNativeSync:fs?t=>t.mkdirSync===g.default.mkdirSync:()=>!1};const{mkdirpNative:ms,mkdirpNativeSync:ys}=cs,{mkdirpManual:bs,mkdirpManualSync:ws}=ns,{useNative:Es,useNativeSync:gs}=ps,_s=(t,e)=>(t=Ki(t),e=Yi(e),Es(e)?ms(t,e):bs(t,e));_s.sync=(t,e)=>(t=Ki(t),e=Yi(e),gs(e)?ys(t,e):ws(t,e)),_s.native=(t,e)=>ms(Ki(t),Yi(e)),_s.manual=(t,e)=>bs(Ki(t),Yi(e)),_s.nativeSync=(t,e)=>ys(Ki(t),Yi(e)),_s.manualSync=(t,e)=>ws(Ki(t),Yi(e));var Ss=_s;const Rs=g.default.lchown?"lchown":"chown",Os=g.default.lchownSync?"lchownSync":"chownSync",vs=g.default.lchown&&!process.version.match(/v1[1-9]+\./)&&!process.version.match(/v10\.[6-9]/),Ts=(t,e,i)=>{try{return g.default[Os](t,e,i)}catch(t){if("ENOENT"!==t.code)throw t}},ks=vs?(t,e,i,s)=>r=>{r&&"EISDIR"===r.code?g.default.chown(t,e,i,s):s(r)}:(t,e,i,s)=>s,Ls=vs?(t,e,i)=>{try{return Ts(t,e,i)}catch(s){if("EISDIR"!==s.code)throw s;((t,e,i)=>{try{g.default.chownSync(t,e,i)}catch(t){if("ENOENT"!==t.code)throw t}})(t,e,i)}}:(t,e,i)=>Ts(t,e,i),As=process.version;let Is=(t,e,i)=>g.default.readdir(t,e,i);/^v4\./.test(As)&&(Is=(t,e,i)=>g.default.readdir(t,i));const Ds=(t,e,i,s)=>{g.default[Rs](t,e,i,ks(t,e,i,(t=>{s(t&&"ENOENT"!==t.code?t:null)})))},Ns=(t,e,i,s,r)=>{if("string"==typeof e)return g.default.lstat(d.default.resolve(t,e),((n,h)=>{if(n)return r("ENOENT"!==n.code?n:null);h.name=e,Ns(t,h,i,s,r)}));if(e.isDirectory())xs(d.default.resolve(t,e.name),i,s,(n=>{if(n)return r(n);const h=d.default.resolve(t,e.name);Ds(h,i,s,r)}));else{const n=d.default.resolve(t,e.name);Ds(n,i,s,r)}},xs=(t,e,i,s)=>{Is(t,{withFileTypes:!0},((r,n)=>{if(r){if("ENOENT"===r.code)return s();if("ENOTDIR"!==r.code&&"ENOTSUP"!==r.code)return s(r)}if(r||!n.length)return Ds(t,e,i,s);let h=n.length,o=null;const a=r=>{if(!o)return r?s(o=r):0==--h?Ds(t,e,i,s):void 0};n.forEach((s=>Ns(t,s,e,i,a)))}))},Bs=(t,e,i)=>{let s;try{s=((t,e)=>g.default.readdirSync(t,e))(t,{withFileTypes:!0})}catch(s){if("ENOENT"===s.code)return;if("ENOTDIR"===s.code||"ENOTSUP"===s.code)return Ls(t,e,i);throw s}return s&&s.length&&s.forEach((s=>((t,e,i,s)=>{if("string"==typeof e)try{const i=g.default.lstatSync(d.default.resolve(t,e));i.name=e,e=i}catch(t){if("ENOENT"===t.code)return;throw t}e.isDirectory()&&Bs(d.default.resolve(t,e.name),i,s),Ls(d.default.resolve(t,e.name),i,s)})(t,s,e,i))),Ls(t,e,i)};var Ms=xs;xs.sync=Bs;var Cs=O((function(t){class e extends Error{constructor(t,e){super("Cannot extract through symbolic link"),this.path=e,this.symlink=t}get name(){return"SylinkError"}}class i extends Error{constructor(t,e){super(e+": Cannot cd into '"+t+"'"),this.path=t,this.code=e}get name(){return"CwdError"}}t.exports=(t,e,r)=>{const n=e.umask,h=448|e.mode,o=0!=(h&n),a=e.uid,l=e.gid,u="number"==typeof a&&"number"==typeof l&&(a!==e.processUid||l!==e.processGid),c=e.preserve,f=e.unlink,p=e.cache,m=e.cwd,y=(e,i)=>{e?r(e):(p.set(t,!0),i&&u?Ms(i,a,l,(t=>y(t))):o?g.default.chmod(t,h,r):r())};if(p&&!0===p.get(t))return y();if(t===m)return g.default.stat(t,((e,s)=>{!e&&s.isDirectory()||(e=new i(t,e&&e.code||"ENOTDIR")),y(e)}));if(c)return Ss(t,{mode:h}).then((t=>y(null,t)),y);const b=d.default.relative(m,t).split(/\/|\\/);s(m,b,h,p,f,m,null,y)};const s=(t,e,i,n,h,o,a,l)=>{if(!e.length)return l(null,a);const u=t+"/"+e.shift();if(n.get(u))return s(u,e,i,n,h,o,a,l);g.default.mkdir(u,i,r(u,e,i,n,h,o,a,l))},r=(t,n,h,o,a,l,u,c)=>f=>{if(f){if(f.path&&d.default.dirname(f.path)===l&&("ENOTDIR"===f.code||"ENOENT"===f.code))return c(new i(l,f.code));g.default.lstat(t,((i,d)=>{if(i)c(i);else if(d.isDirectory())s(t,n,h,o,a,l,u,c);else if(a)g.default.unlink(t,(e=>{if(e)return c(e);g.default.mkdir(t,h,r(t,n,h,o,a,l,u,c))}));else{if(d.isSymbolicLink())return c(new e(t,t+"/"+n.join("/")));c(f)}}))}else s(t,n,h,o,a,l,u=u||t,c)};t.exports.sync=(t,s)=>{const r=s.umask,n=448|s.mode,h=0!=(n&r),o=s.uid,a=s.gid,l="number"==typeof o&&"number"==typeof a&&(o!==s.processUid||a!==s.processGid),u=s.preserve,c=s.unlink,f=s.cache,p=s.cwd,m=e=>{f.set(t,!0),e&&l&&Ms.sync(e,o,a),h&&g.default.chmodSync(t,n)};if(f&&!0===f.get(t))return m();if(t===p){let e=!1,s="ENOTDIR";try{e=g.default.statSync(t).isDirectory()}catch(t){s=t.code}finally{if(!e)throw new i(t,s)}return void m()}if(u)return m(Ss.sync(t,n));const y=d.default.relative(p,t).split(/\/|\\/);let b=null;for(let t=y.shift(),s=p;t&&(s+="/"+t);t=y.shift())if(!f.get(s))try{g.default.mkdirSync(s,n),b=b||s,f.set(s,!0)}catch(t){if(t.path&&d.default.dirname(t.path)===p&&("ENOTDIR"===t.code||"ENOENT"===t.code))return new i(p,t.code);const r=g.default.lstatSync(s);if(r.isDirectory()){f.set(s,!0);continue}if(c){g.default.unlinkSync(s),g.default.mkdirSync(s,n),b=b||s,f.set(s,!0);continue}if(r.isSymbolicLink())return new e(s,s+"/"+y.join("/"))}return m(b)}})),Fs=()=>{const t=new Map,e=new Map,{join:i}=d.default,s=new Set,r=i=>{const{paths:s,dirs:r}=(i=>{const s=e.get(i);if(!s)throw new Error("function does not have any path reservations");return{paths:s.paths.map((e=>t.get(e))),dirs:[...s.dirs].map((e=>t.get(e)))}})(i);return s.every((t=>t[0]===i))&&r.every((t=>t[0]instanceof Set&&t[0].has(i)))},n=t=>!(s.has(t)||!r(t))&&(s.add(t),t((()=>h(t))),!0),h=i=>{if(!s.has(i))return!1;const{paths:r,dirs:h}=e.get(i),o=new Set;return r.forEach((e=>{const s=t.get(e);b.default.equal(s[0],i),1===s.length?t.delete(e):(s.shift(),"function"==typeof s[0]?o.add(s[0]):s[0].forEach((t=>o.add(t))))})),h.forEach((e=>{const s=t.get(e);b.default(s[0]instanceof Set),1===s[0].size&&1===s.length?t.delete(e):1===s[0].size?(s.shift(),o.add(s[0])):s[0].delete(i)})),s.delete(i),o.forEach((t=>n(t))),!0};return{check:r,reserve:(s,r)=>{const h=new Set(s.map((t=>(t=>i(t).split(/[\\\/]/).slice(0,-1).reduce(((t,e)=>t.length?t.concat(i(t[t.length-1],e)):[e]),[]))(t))).reduce(((t,e)=>t.concat(e))));return e.set(r,{dirs:h,paths:s}),s.forEach((e=>{const i=t.get(e);i?i.push(r):t.set(e,[r])})),h.forEach((e=>{const i=t.get(e);i?i[i.length-1]instanceof Set?i[i.length-1].add(r):i.push(new Set([r])):t.set(e,[new Set([r])])})),n(r)}}};const Ps="win32"===(process.env.__FAKE_PLATFORM__||process.platform),zs=R.__FAKE_TESTING_FS__||g.default,{O_CREAT:Us,O_TRUNC:js,O_WRONLY:Hs,UV_FS_O_FILEMAP:Gs=0}=zs.constants,Zs=Gs|js|Us|Hs;var Ws=Ps&&!!Gs?t=>t<524288?Zs:"w":()=>"w";p.default.EventEmitter,Cs.sync;const Vs=Symbol("onEntry"),Ys=Symbol("checkFs"),$s=Symbol("checkFs2"),qs=Symbol("isReusable"),Xs=Symbol("makeFs"),Ks=Symbol("file"),Qs=Symbol("directory"),Js=Symbol("link"),tr=Symbol("symlink"),er=Symbol("hardlink"),ir=Symbol("unsupported"),sr=Symbol("checkPath"),rr=Symbol("mkdir"),nr=Symbol("onError"),hr=Symbol("pending"),or=Symbol("pend"),ar=Symbol("unpend"),lr=Symbol("ended"),ur=Symbol("maybeClose"),cr=Symbol("skip"),dr=Symbol("doChown"),fr=Symbol("uid"),pr=Symbol("gid"),mr=()=>{throw new Error("sync function called cb somehow?!?")},yr=(t,e,i)=>t===t>>>0?t:e===e>>>0?e:i;class br extends ji{constructor(t){if(t||(t={}),t.ondone=t=>{this[lr]=!0,this[ur]()},super(t),this.reservations=Fs(),this.transform="function"==typeof t.transform?t.transform:null,this.writable=!0,this.readable=!1,this[hr]=0,this[lr]=!1,this.dirCache=t.dirCache||new Map,"number"==typeof t.uid||"number"==typeof t.gid){if("number"!=typeof t.uid||"number"!=typeof t.gid)throw new TypeError("cannot set owner without number uid and gid");if(t.preserveOwner)throw new TypeError("cannot preserve owner in archive and also set owner explicitly");this.uid=t.uid,this.gid=t.gid,this.setOwner=!0}else this.uid=null,this.gid=null,this.setOwner=!1;void 0===t.preserveOwner&&"number"!=typeof t.uid?this.preserveOwner=process.getuid&&0===process.getuid():this.preserveOwner=!!t.preserveOwner,this.processUid=(this.preserveOwner||this.setOwner)&&process.getuid?process.getuid():null,this.processGid=(this.preserveOwner||this.setOwner)&&process.getgid?process.getgid():null,this.forceChown=!0===t.forceChown,this.win32=!!t.win32||"win32"===process.platform,this.newer=!!t.newer,this.keep=!!t.keep,this.noMtime=!!t.noMtime,this.preservePaths=!!t.preservePaths,this.unlink=!!t.unlink,this.cwd=d.default.resolve(t.cwd||process.cwd()),this.strip=+t.strip||0,this.processUmask=process.umask(),this.umask="number"==typeof t.umask?t.umask:this.processUmask,this.dmode=t.dmode||511&~this.umask,this.fmode=t.fmode||438&~this.umask,this.on("entry",(t=>this[Vs](t)))}warn(t,e,i={}){return"TAR_BAD_ARCHIVE"!==t&&"TAR_ABORT"!==t||(i.recoverable=!1),super.warn(t,e,i)}[ur](){this[lr]&&0===this[hr]&&(this.emit("prefinish"),this.emit("finish"),this.emit("end"),this.emit("close"))}[sr](t){if(this.strip){const e=t.path.split(/\/|\\/);if(e.length<this.strip)return!1;if(t.path=e.slice(this.strip).join("/"),"Link"===t.type){const e=t.linkpath.split(/\/|\\/);e.length>=this.strip&&(t.linkpath=e.slice(this.strip).join("/"))}}if(!this.preservePaths){const e=t.path;if(e.match(/(^|\/|\\)\.\.(\\|\/|$)/))return this.warn("TAR_ENTRY_ERROR","path contains '..'",{entry:t,path:e}),!1;if(d.default.win32.isAbsolute(e)){const i=d.default.win32.parse(e);t.path=e.substr(i.root.length);const s=i.root;this.warn("TAR_ENTRY_INFO",`stripping ${s} from absolute path`,{entry:t,path:e})}}if(this.win32){const e=d.default.win32.parse(t.path);t.path=""===e.root?Ft(t.path):e.root+Ft(t.path.substr(e.root.length))}return d.default.isAbsolute(t.path)?t.absolute=t.path:t.absolute=d.default.resolve(this.cwd,t.path),!0}[Vs](t){if(!this[sr](t))return t.resume();switch(b.default.equal(typeof t.absolute,"string"),t.type){case"Directory":case"GNUDumpDir":t.mode&&(t.mode=448|t.mode);case"File":case"OldFile":case"ContiguousFile":case"Link":case"SymbolicLink":return this[Ys](t);case"CharacterDevice":case"BlockDevice":case"FIFO":return this[ir](t)}}[nr](t,e){"CwdError"===t.name?this.emit("error",t):(this.warn("TAR_ENTRY_ERROR",t,{entry:e}),this[ar](),e.resume())}[rr](t,e,i){Cs(t,{uid:this.uid,gid:this.gid,processUid:this.processUid,processGid:this.processGid,umask:this.processUmask,preserve:this.preservePaths,unlink:this.unlink,cache:this.dirCache,cwd:this.cwd,mode:e},i)}[dr](t){return this.forceChown||this.preserveOwner&&("number"==typeof t.uid&&t.uid!==this.processUid||"number"==typeof t.gid&&t.gid!==this.processGid)||"number"==typeof this.uid&&this.uid!==this.processUid||"number"==typeof this.gid&&this.gid!==this.processGid}[fr](t){return yr(this.uid,t.uid,this.processUid)}[pr](t){return yr(this.gid,t.gid,this.processGid)}[Ks](t,e){const i=4095&t.mode||this.fmode,s=new li.WriteStream(t.absolute,{flags:Ws(t.size),mode:i,autoClose:!1});s.on("error",(e=>this[nr](e,t)));let r=1;const n=i=>{if(i)return this[nr](i,t);0==--r&&g.default.close(s.fd,(i=>{e(),i?this[nr](i,t):this[ar]()}))};s.on("finish",(e=>{const i=t.absolute,h=s.fd;if(t.mtime&&!this.noMtime){r++;const e=t.atime||new Date,s=t.mtime;g.default.futimes(h,e,s,(t=>t?g.default.utimes(i,e,s,(e=>n(e&&t))):n()))}if(this[dr](t)){r++;const e=this[fr](t),s=this[pr](t);g.default.fchown(h,e,s,(t=>t?g.default.chown(i,e,s,(e=>n(e&&t))):n()))}n()}));const h=this.transform&&this.transform(t)||t;h!==t&&(h.on("error",(e=>this[nr](e,t))),t.pipe(h)),h.pipe(s)}[Qs](t,e){const i=4095&t.mode||this.dmode;this[rr](t.absolute,i,(i=>{if(i)return e(),this[nr](i,t);let s=1;const r=i=>{0==--s&&(e(),this[ar](),t.resume())};t.mtime&&!this.noMtime&&(s++,g.default.utimes(t.absolute,t.atime||new Date,t.mtime,r)),this[dr](t)&&(s++,g.default.chown(t.absolute,this[fr](t),this[pr](t),r)),r()}))}[ir](t){t.unsupported=!0,this.warn("TAR_ENTRY_UNSUPPORTED",`unsupported entry type: ${t.type}`,{entry:t}),t.resume()}[tr](t,e){this[Js](t,t.linkpath,"symlink",e)}[er](t,e){this[Js](t,d.default.resolve(this.cwd,t.linkpath),"link",e)}[or](){this[hr]++}[ar](){this[hr]--,this[ur]()}[cr](t){this[ar](),t.resume()}[qs](t,e){return"File"===t.type&&!this.unlink&&e.isFile()&&e.nlink<=1&&"win32"!==process.platform}[Ys](t){this[or]();const e=[t.path];t.linkpath&&e.push(t.linkpath),this.reservations.reserve(e,(e=>this[$s](t,e)))}[$s](t,e){this[rr](d.default.dirname(t.absolute),this.dmode,(i=>{if(i)return e(),this[nr](i,t);g.default.lstat(t.absolute,((i,s)=>{s&&(this.keep||this.newer&&s.mtime>t.mtime)?(this[cr](t),e()):i||this[qs](t,s)?this[Xs](null,t,e):s.isDirectory()?"Directory"===t.type?t.mode&&(4095&s.mode)!==t.mode?g.default.chmod(t.absolute,t.mode,(i=>this[Xs](i,t,e))):this[Xs](null,t,e):g.default.rmdir(t.absolute,(i=>this[Xs](i,t,e))):((t,e)=>{if("win32"!==process.platform)return g.default.unlink(t,e);const i=t+".DELETE."+S.default.randomBytes(16).toString("hex");g.default.rename(t,i,(t=>{if(t)return e(t);g.default.unlink(i,e)}))})(t.absolute,(i=>this[Xs](i,t,e)))}))}))}[Xs](t,e,i){if(t)return this[nr](t,e);switch(e.type){case"File":case"OldFile":case"ContiguousFile":return this[Ks](e,i);case"Link":return this[er](e,i);case"SymbolicLink":return this[tr](e,i);case"Directory":case"GNUDumpDir":return this[Qs](e,i)}}[Js](t,e,i,s){g.default[i](e,t.absolute,(e=>{if(e)return this[nr](e,t);s(),this[ar](),t.resume()}))}}br.Sync=class extends br{constructor(t){super(t)}[Ys](t){const e=this[rr](d.default.dirname(t.absolute),this.dmode,mr);if(e)return this[nr](e,t);try{const i=g.default.lstatSync(t.absolute);if(this.keep||this.newer&&i.mtime>t.mtime)return this[cr](t);if(this[qs](t,i))return this[Xs](null,t,mr);try{return i.isDirectory()?"Directory"===t.type?t.mode&&(4095&i.mode)!==t.mode&&g.default.chmodSync(t.absolute,t.mode):g.default.rmdirSync(t.absolute):(t=>{if("win32"!==process.platform)return g.default.unlinkSync(t);const e=t+".DELETE."+S.default.randomBytes(16).toString("hex");g.default.renameSync(t,e),g.default.unlinkSync(e)})(t.absolute),this[Xs](null,t,mr)}catch(e){return this[nr](e,t)}}catch(e){return this[Xs](null,t,mr)}}[Ks](t,e){const i=4095&t.mode||this.fmode,s=e=>{let i;try{g.default.closeSync(r)}catch(t){i=t}(e||i)&&this[nr](e||i,t)};let r;try{r=g.default.openSync(t.absolute,Ws(t.size),i)}catch(t){return s(t)}const n=this.transform&&this.transform(t)||t;n!==t&&(n.on("error",(e=>this[nr](e,t))),t.pipe(n)),n.on("data",(t=>{try{g.default.writeSync(r,t,0,t.length)}catch(t){s(t)}})),n.on("end",(e=>{let i=null;if(t.mtime&&!this.noMtime){const e=t.atime||new Date,s=t.mtime;try{g.default.futimesSync(r,e,s)}catch(r){try{g.default.utimesSync(t.absolute,e,s)}catch(t){i=r}}}if(this[dr](t)){const e=this[fr](t),s=this[pr](t);try{g.default.fchownSync(r,e,s)}catch(r){try{g.default.chownSync(t.absolute,e,s)}catch(t){i=i||r}}}s(i)}))}[Qs](t,e){const i=4095&t.mode||this.dmode,s=this[rr](t.absolute,i);if(s)return this[nr](s,t);if(t.mtime&&!this.noMtime)try{g.default.utimesSync(t.absolute,t.atime||new Date,t.mtime)}catch(s){}if(this[dr](t))try{g.default.chownSync(t.absolute,this[fr](t),this[pr](t))}catch(s){}t.resume()}[rr](t,e){try{return Cs.sync(t,{uid:this.uid,gid:this.gid,processUid:this.processUid,processGid:this.processGid,umask:this.processUmask,preserve:this.preservePaths,unlink:this.unlink,cache:this.dirCache,cwd:this.cwd,mode:e})}catch(t){return t}}[Js](t,e,i,s){try{g.default[i+"Sync"](e,t.absolute),t.resume()}catch(e){return this[nr](e,t)}}};var wr=br,Er=O((function(t){t.exports=(t,h,o)=>{"function"==typeof t?(o=t,h=null,t={}):Array.isArray(t)&&(h=t,t={}),"function"==typeof h&&(o=h,h=null),h=h?Array.from(h):[];const a=v(t);if(a.sync&&"function"==typeof o)throw new TypeError("callback not supported for sync tar functions");if(!a.file&&"function"==typeof o)throw new TypeError("callback only supported with file option");return h.length&&e(a,h),a.file&&a.sync?i(a):a.file?s(a,o):a.sync?r(a):n(a)};const e=(t,e)=>{const i=new Map(e.map((t=>[t.replace(/\/+$/,""),!0]))),s=t.filter,r=(t,e)=>{const s=e||d.default.parse(t).root||".",n=t!==s&&(i.has(t)?i.get(t):r(d.default.dirname(t),s));return i.set(t,n),n};t.filter=s?(t,e)=>s(t,e)&&r(t.replace(/\/+$/,"")):t=>r(t.replace(/\/+$/,""))},i=t=>{const e=new wr.Sync(t),i=t.file,s=g.default.statSync(i),r=t.maxReadSize||16777216;new li.ReadStreamSync(i,{readSize:r,size:s.size}).pipe(e)},s=(t,e)=>{const i=new wr(t),s=t.maxReadSize||16777216,r=t.file,n=new Promise(((t,e)=>{i.on("error",e),i.on("close",t),g.default.stat(r,((t,n)=>{if(t)e(t);else{const t=new li.ReadStream(r,{readSize:s,size:n.size});t.on("error",e),t.pipe(i)}}))}));return e?n.then(e,e):n},r=t=>new wr.Sync(t),n=t=>new wr(t)})),gr=O((function(t,e){e.c=e.create=Gi,e.r=e.replace=Zi,e.t=e.list=Hi,e.u=e.update=Wi,e.x=e.extract=Er,e.Pack=Ie,e.Unpack=wr,e.Parse=ji,e.ReadEntry=ot,e.WriteEntry=re,e.Header=Tt,e.Pax=Dt,e.types=nt})),_r=["write","end","destroy"],Sr=["resume","pause"],Rr=["data","close"],Or=Array.prototype.slice,vr=function(t,e){var i=new m.default,s=!1;return Tr(_r,(function(e){function s(){return t[e].apply(t,arguments)}i[e]=s})),Tr(Sr,(function(t){function s(){i.emit(t);var s=e[t];if(s)return s.apply(e,arguments);e.emit(t)}i[t]=s})),Tr(Rr,(function(t){function s(){var e=Or.call(arguments);e.unshift(t),i.emit.apply(i,e)}e.on(t,s)})),e.on("end",(function(){if(s)return;s=!0;var t=Or.call(arguments);t.unshift("end"),i.emit.apply(i,t)})),t.on("drain",(function(){i.emit("drain")})),t.on("error",r),e.on("error",r),i.writable=t.writable,i.readable=e.readable,i;function r(t){i.emit("error",t)}};function Tr(t,e){if(t.forEach)return t.forEach(e);for(var i=0;i<t.length;i++)e(t[i],i)}var kr=O((function(t){const{promisify:e}=_.default,i=t=>({level:9,...t}),s=e(E.default.gzip);t.exports=async(t,e)=>{if(!t)return 0;return(await s(t,i(e))).length},t.exports.sync=(t,e)=>E.default.gzipSync(t,i(e)).length,t.exports.stream=t=>{const e=new m.default.PassThrough,s=new m.default.PassThrough,r=vr(e,s);let n=0;const h=E.default.createGzip(i(t)).on("data",(t=>{n+=t.length})).on("error",(()=>{r.gzipSize=0})).on("end",(()=>{r.gzipSize=n,r.emit("gzip-size",n),s.end()}));return e.pipe(h),e.pipe(s,{end:!1}),r},t.exports.file=(e,i)=>new Promise(((s,r)=>{const n=g.default.createReadStream(e);n.on("error",r);const h=n.pipe(t.exports.stream(i));h.on("error",r),h.on("gzip-size",s)})),t.exports.fileSync=(e,i)=>t.exports.sync(g.default.readFileSync(e),i)}));_.default.promisify(g.default.readFile);var Lr=async function(t,e){const i=(t=>"string"==typeof t?Buffer.from(t,"utf8"):t)(t);return new Promise((function(t,s){var r,n;E.default.brotliCompress(i,(r=e,n=i,{params:{[E.default.constants.BROTLI_PARAM_MODE]:r&&"mode"in r&&r.mode||E.default.constants.BROTLI_DEFAULT_MODE,[E.default.constants.BROTLI_PARAM_QUALITY]:r&&"quality"in r&&r.quality||E.default.constants.BROTLI_MAX_QUALITY,[E.default.constants.BROTLI_PARAM_SIZE_HINT]:n?n.byteLength:0}}),((e,i)=>{null!==e&&s(e),t(i.byteLength)}))}))};const Ar=async t=>{const e=await async function(t){const e=[];for await(const i of t)e.push(i);return Buffer.concat(e)}(t),[i,s]=await Promise.all([kr(e),Lr(e)]);return{path:t.path.replace(/^[^/]+\/?/,"/"),mode:t.mode,size:t.size,sizeGzip:i,sizeBrotli:s}};module.exports=async function(t=""){t=d.default.resolve(t);const e=await f.default(t),i=await(async t=>new Promise(((e,i)=>{const s=[];gr.list({noResume:!0}).on("entry",(t=>{s.push(Ar(t))})).on("error",(t=>i(t))).on("finish",(()=>e(Promise.all(s)))).end(t)})))(e);return{pkgPath:t,tarballSize:e.length,files:i}};
